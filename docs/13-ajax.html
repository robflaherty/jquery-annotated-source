<!DOCTYPE html>
<html>
<head><title>13-ajax.js</title>
   <meta http-equiv="content-type" content="text/html; charset=UTF-8">
   <link rel="stylesheet" media="all" href="docco.css"/>
</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead>
<tr>
   <th class="docs"><h1> 13-ajax.js </h1></th>
   <th class="code"></th>
</tr>
</thead>
<tbody>
<tr id="section-1">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div>
      <p><strong>jQuery Annotated Source</strong>.</p>

      <p><a href="/jquery-annotated-source/">Home</a> | <a href="12-css.html">Previous Chapter</a> |
         <a href="14-effects.html">Next Chapter</a></p></td>
   <td class="code">
      <div class="highlight">
         <pre></pre>
      </div>
   </td>
</tr>
<tr id="section-2">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-2">&#182;</a></div>
      <h2>Chapter 13: Ajax</h2></td>
   <td class="code">
      <div class="highlight"><pre>

<span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">jQuery</span><span class="p">)</span> <span class="p">{</span>

   <span class="kd">var</span> <span class="nx">r20</span> <span class="o">=</span> <span class="sr">/%20/g</span><span class="p">,</span>
         <span class="nx">rbracket</span> <span class="o">=</span> <span class="sr">/\[\]$/</span><span class="p">,</span>
         <span class="nx">rCRLF</span> <span class="o">=</span> <span class="sr">/\r?\n/g</span><span class="p">,</span>
         <span class="nx">rhash</span> <span class="o">=</span> <span class="sr">/#.*$/</span><span class="p">,</span>
         <span class="nx">rheaders</span> <span class="o">=</span> <span class="sr">/^(.*?):[ \t]*([^\r\n]*)\r?$/mg</span><span class="p">,</span> <span class="c1">// IE leaves an \r character at EOL</span>
         <span class="nx">rinput</span> <span class="o">=</span> <span class="sr">/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i</span><span class="p">,</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-3">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-3">&#182;</a></div>
      <p>7653, 8125, 8152: local protocol detection</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">rlocalProtocol</span> <span class="o">=</span> <span class="sr">/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/</span><span class="p">,</span>
         <span class="nx">rnoContent</span> <span class="o">=</span> <span class="sr">/^(?:GET|HEAD)$/</span><span class="p">,</span>
         <span class="nx">rprotocol</span> <span class="o">=</span> <span class="sr">/^\/\//</span><span class="p">,</span>
         <span class="nx">rquery</span> <span class="o">=</span> <span class="sr">/\?/</span><span class="p">,</span>
         <span class="nx">rscript</span> <span class="o">=</span> <span class="sr">/&lt;script\b[^&lt;]*(?:(?!&lt;\/script&gt;)&lt;[^&lt;]*)*&lt;\/script&gt;/gi</span><span class="p">,</span>
         <span class="nx">rselectTextarea</span> <span class="o">=</span> <span class="sr">/^(?:select|textarea)/i</span><span class="p">,</span>
         <span class="nx">rspacesAjax</span> <span class="o">=</span> <span class="sr">/\s+/</span><span class="p">,</span>
         <span class="nx">rts</span> <span class="o">=</span> <span class="sr">/([?&amp;])_=[^&amp;]*/</span><span class="p">,</span>
         <span class="nx">rurl</span> <span class="o">=</span> <span class="sr">/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/</span><span class="p">,</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-4">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-4">&#182;</a></div>
      <p>Keep a copy of the old load method</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">_load</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">load</span><span class="p">,</span>

   <span class="cm">/* Prefilters</span>
<span class="cm">    * 1) They are useful to introduce custom dataTypes (see ajax/jsonp.js for an example)</span>
<span class="cm">    * 2) These are called:</span>
<span class="cm">    *    - BEFORE asking for a transport</span>
<span class="cm">    *    - AFTER param serialization (s.data is a string if s.processData is true)</span>
<span class="cm">    * 3) key is the dataType</span>
<span class="cm">    * 4) the catchall symbol &quot;*&quot; can be used</span>
<span class="cm">    * 5) execution will start with transport dataType and THEN continue down to &quot;*&quot; if needed</span>
<span class="cm">    */</span>
         <span class="nx">prefilters</span> <span class="o">=</span> <span class="p">{},</span>

   <span class="cm">/* Transports bindings</span>
<span class="cm">    * 1) key is the dataType</span>
<span class="cm">    * 2) the catchall symbol &quot;*&quot; can be used</span>
<span class="cm">    * 3) selection will start with transport dataType and THEN go to &quot;*&quot; if needed</span>
<span class="cm">    */</span>
         <span class="nx">transports</span> <span class="o">=</span> <span class="p">{},</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-5">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-5">&#182;</a></div>
      <p>Document location</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">ajaxLocation</span><span class="p">,</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-6">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-6">&#182;</a></div>
      <p>Document location segments</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">ajaxLocParts</span><span class="p">,</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-7">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-7">&#182;</a></div>
      <p>Avoid comment-prolog char sequence (#10098); must appease lint and evade compression</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">allTypes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;*/&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">];</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-8">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-8">&#182;</a></div>
      <p>8138, IE may throw an exception when accessing
         a field from window.location if document.domain has been set</p></td>
   <td class="code">
      <div class="highlight"><pre>
   <span class="k">try</span> <span class="p">{</span>
      <span class="nx">ajaxLocation</span> <span class="o">=</span> <span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">;</span>
   <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-9">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-9">&#182;</a></div>
      <p>Use the href attribute of an A element
         since IE will modify it given document.location</p></td>
   <td class="code">
      <div class="highlight"><pre>
      <span class="nx">ajaxLocation</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">);</span>
      <span class="nx">ajaxLocation</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
      <span class="nx">ajaxLocation</span> <span class="o">=</span> <span class="nx">ajaxLocation</span><span class="p">.</span><span class="nx">href</span><span class="p">;</span>
   <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-10">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-10">&#182;</a></div>
      <p>Segment location into parts</p></td>
   <td class="code">
      <div class="highlight"><pre>
   <span class="nx">ajaxLocParts</span> <span class="o">=</span> <span class="nx">rurl</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">ajaxLocation</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">())</span> <span class="o">||</span> <span class="p">[];</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-11">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-11">&#182;</a></div>
      <p>Base "constructor" for jQuery.ajaxPrefilter and jQuery.ajaxTransport</p></td>
   <td class="code">
      <div class="highlight"><pre>
   <span class="kd">function</span> <span class="nx">addToPrefiltersOrTransports</span><span class="p">(</span><span class="nx">structure</span><span class="p">)</span> <span class="p">{</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-12">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-12">&#182;</a></div>
      <p>dataTypeExpression is optional and defaults to "*"</p></td>
   <td class="code">
      <div class="highlight"><pre>
      <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">dataTypeExpression</span><span class="p">,</span> <span class="nx">func</span><span class="p">)</span> <span class="p">{</span>

         <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">dataTypeExpression</span> <span class="o">!==</span> <span class="s2">&quot;string&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">func</span> <span class="o">=</span> <span class="nx">dataTypeExpression</span><span class="p">;</span>
            <span class="nx">dataTypeExpression</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span><span class="p">;</span>
         <span class="p">}</span>

         <span class="k">if</span> <span class="p">(</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">func</span><span class="p">))</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">dataTypes</span> <span class="o">=</span> <span class="nx">dataTypeExpression</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">split</span><span class="p">(</span><span class="nx">rspacesAjax</span><span class="p">),</span>
                  <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                  <span class="nx">length</span> <span class="o">=</span> <span class="nx">dataTypes</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
                  <span class="nx">dataType</span><span class="p">,</span>
                  <span class="nx">list</span><span class="p">,</span>
                  <span class="nx">placeBefore</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-13">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-13">&#182;</a></div>
      <p>For each dataType in the dataTypeExpression</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="k">for</span> <span class="p">(;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">dataType</span> <span class="o">=</span> <span class="nx">dataTypes</span><span class="p">[</span> <span class="nx">i</span> <span class="p">];</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-14">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-14">&#182;</a></div>
      <p>We control if we're asked to add before
         any existing element</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">placeBefore</span> <span class="o">=</span> <span class="sr">/^\+/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">dataType</span><span class="p">);</span>
               <span class="k">if</span> <span class="p">(</span><span class="nx">placeBefore</span><span class="p">)</span> <span class="p">{</span>
                  <span class="nx">dataType</span> <span class="o">=</span> <span class="nx">dataType</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">||</span> <span class="s2">&quot;*&quot;</span><span class="p">;</span>
               <span class="p">}</span>
               <span class="nx">list</span> <span class="o">=</span> <span class="nx">structure</span><span class="p">[</span> <span class="nx">dataType</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">structure</span><span class="p">[</span> <span class="nx">dataType</span> <span class="p">]</span> <span class="o">||</span> <span class="p">[];</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-15">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-15">&#182;</a></div>
      <p>then we add to the structure accordingly</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">list</span><span class="p">[</span> <span class="nx">placeBefore</span> <span class="o">?</span> <span class="s2">&quot;unshift&quot;</span> <span class="o">:</span> <span class="s2">&quot;push&quot;</span> <span class="p">](</span><span class="nx">func</span><span class="p">);</span>
            <span class="p">}</span>
         <span class="p">}</span>
      <span class="p">};</span>
   <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-16">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-16">&#182;</a></div>
      <p>Base inspection function for prefilters and transports</p></td>
   <td class="code">
      <div class="highlight"><pre>
   <span class="kd">function</span> <span class="nx">inspectPrefiltersOrTransports</span><span class="p">(</span><span class="nx">structure</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">originalOptions</span><span class="p">,</span> <span class="nx">jqXHR</span><span class="p">,</span> <span class="nx">dataType</span> <span class="cm">/* internal */</span><span class="p">,</span> <span class="nx">inspected</span> <span class="cm">/* internal */</span><span class="p">)</span> <span class="p">{</span>

      <span class="nx">dataType</span> <span class="o">=</span> <span class="nx">dataType</span> <span class="o">||</span> <span class="nx">options</span><span class="p">.</span><span class="nx">dataTypes</span><span class="p">[</span> <span class="mi">0</span> <span class="p">];</span>
      <span class="nx">inspected</span> <span class="o">=</span> <span class="nx">inspected</span> <span class="o">||</span> <span class="p">{};</span>

      <span class="nx">inspected</span><span class="p">[</span> <span class="nx">dataType</span> <span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

      <span class="kd">var</span> <span class="nx">list</span> <span class="o">=</span> <span class="nx">structure</span><span class="p">[</span> <span class="nx">dataType</span> <span class="p">],</span>
            <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nx">length</span> <span class="o">=</span> <span class="nx">list</span> <span class="o">?</span> <span class="nx">list</span><span class="p">.</span><span class="nx">length</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nx">executeOnly</span> <span class="o">=</span> <span class="p">(</span> <span class="nx">structure</span> <span class="o">===</span> <span class="nx">prefilters</span> <span class="p">),</span>
            <span class="nx">selection</span><span class="p">;</span>

      <span class="k">for</span> <span class="p">(;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="nx">executeOnly</span> <span class="o">||</span> <span class="o">!</span><span class="nx">selection</span> <span class="p">);</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
         <span class="nx">selection</span> <span class="o">=</span> <span class="nx">list</span><span class="p">[</span> <span class="nx">i</span> <span class="p">](</span><span class="nx">options</span><span class="p">,</span> <span class="nx">originalOptions</span><span class="p">,</span> <span class="nx">jqXHR</span><span class="p">);</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-17">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-17">&#182;</a></div>
      <p>If we got redirected to another dataType
         we try there if executing only and not done already</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">selection</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">executeOnly</span> <span class="o">||</span> <span class="nx">inspected</span><span class="p">[</span> <span class="nx">selection</span> <span class="p">])</span> <span class="p">{</span>
               <span class="nx">selection</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
               <span class="nx">options</span><span class="p">.</span><span class="nx">dataTypes</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">selection</span><span class="p">);</span>
               <span class="nx">selection</span> <span class="o">=</span> <span class="nx">inspectPrefiltersOrTransports</span><span class="p">(</span>
                     <span class="nx">structure</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">originalOptions</span><span class="p">,</span> <span class="nx">jqXHR</span><span class="p">,</span> <span class="nx">selection</span><span class="p">,</span> <span class="nx">inspected</span><span class="p">);</span>
            <span class="p">}</span>
         <span class="p">}</span>
      <span class="p">}</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-18">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-18">&#182;</a></div>
      <p>If we're only executing or nothing was selected
         we try the catchall dataType if not done already</p></td>
   <td class="code">
      <div class="highlight"><pre>
      <span class="k">if</span> <span class="p">((</span> <span class="nx">executeOnly</span> <span class="o">||</span> <span class="o">!</span><span class="nx">selection</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">inspected</span><span class="p">[</span> <span class="s2">&quot;*&quot;</span> <span class="p">])</span> <span class="p">{</span>
         <span class="nx">selection</span> <span class="o">=</span> <span class="nx">inspectPrefiltersOrTransports</span><span class="p">(</span>
               <span class="nx">structure</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">originalOptions</span><span class="p">,</span> <span class="nx">jqXHR</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="nx">inspected</span><span class="p">);</span>
      <span class="p">}</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-19">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-19">&#182;</a></div>
      <p>unnecessary when only executing (prefilters)
         but it'll be ignored by the caller in that case</p></td>
   <td class="code">
      <div class="highlight"><pre>
      <span class="k">return</span> <span class="nx">selection</span><span class="p">;</span>
   <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-20">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-20">&#182;</a></div>
      <p>A special extend for ajax options
         that takes "flat" options (not to be deep extended)
         Fixes #9887</p></td>
   <td class="code">
      <div class="highlight"><pre>
   <span class="kd">function</span> <span class="nx">ajaxExtend</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">src</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">deep</span><span class="p">,</span>
            <span class="nx">flatOptions</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ajaxSettings</span><span class="p">.</span><span class="nx">flatOptions</span> <span class="o">||</span> <span class="p">{};</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">src</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">if</span> <span class="p">(</span><span class="nx">src</span><span class="p">[</span> <span class="nx">key</span> <span class="p">]</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="p">(</span> <span class="nx">flatOptions</span><span class="p">[</span> <span class="nx">key</span> <span class="p">]</span> <span class="o">?</span> <span class="nx">target</span> <span class="o">:</span> <span class="p">(</span> <span class="nx">deep</span> <span class="o">||</span> <span class="p">(</span> <span class="nx">deep</span> <span class="o">=</span> <span class="p">{}</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)[</span> <span class="nx">key</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">src</span><span class="p">[</span> <span class="nx">key</span> <span class="p">];</span>
         <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">deep</span><span class="p">)</span> <span class="p">{</span>
         <span class="nx">jQuery</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nx">target</span><span class="p">,</span> <span class="nx">deep</span><span class="p">);</span>
      <span class="p">}</span>
   <span class="p">}</span>

   <span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
      <span class="nx">load</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">params</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">url</span> <span class="o">!==</span> <span class="s2">&quot;string&quot;</span> <span class="o">&amp;&amp;</span> <span class="nx">_load</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">_load</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-21">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-21">&#182;</a></div>
      <p>Don't do a request if no elements are being requested</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
         <span class="p">}</span>

         <span class="kd">var</span> <span class="nx">off</span> <span class="o">=</span> <span class="nx">url</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">);</span>
         <span class="k">if</span> <span class="p">(</span><span class="nx">off</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">selector</span> <span class="o">=</span> <span class="nx">url</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">off</span><span class="p">,</span> <span class="nx">url</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
            <span class="nx">url</span> <span class="o">=</span> <span class="nx">url</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">off</span><span class="p">);</span>
         <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-22">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-22">&#182;</a></div>
      <p>Default to a GET request</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;GET&quot;</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-23">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-23">&#182;</a></div>
      <p>If the second parameter was provided</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">if</span> <span class="p">(</span><span class="nx">params</span><span class="p">)</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-24">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-24">&#182;</a></div>
      <p>If it's a function</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">params</span><span class="p">))</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-25">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-25">&#182;</a></div>
      <p>We assume that it's the callback</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">callback</span> <span class="o">=</span> <span class="nx">params</span><span class="p">;</span>
               <span class="nx">params</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-26">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-26">&#182;</a></div>
      <p>Otherwise, build a param string</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">params</span> <span class="o">===</span> <span class="s2">&quot;object&quot;</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">params</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">param</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ajaxSettings</span><span class="p">.</span><span class="nx">traditional</span><span class="p">);</span>
               <span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;POST&quot;</span><span class="p">;</span>
            <span class="p">}</span>
         <span class="p">}</span>

         <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-27">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-27">&#182;</a></div>
      <p>Request the remote document</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
            <span class="nx">url</span><span class="o">:</span>     <span class="nx">url</span><span class="p">,</span>
            <span class="nx">type</span><span class="o">:</span>    <span class="nx">type</span><span class="p">,</span>
            <span class="nx">dataType</span><span class="o">:</span><span class="s2">&quot;html&quot;</span><span class="p">,</span>
            <span class="nx">data</span><span class="o">:</span>    <span class="nx">params</span><span class="p">,</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-28">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-28">&#182;</a></div>
      <p>Complete callback (responseText is used internally)</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="nx">complete</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">jqXHR</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">responseText</span><span class="p">)</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-29">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-29">&#182;</a></div>
      <p>Store the response as specified by the jqXHR object</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">responseText</span> <span class="o">=</span> <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-30">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-30">&#182;</a></div>
      <p>If successful, inject the HTML into all the matched elements</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="k">if</span> <span class="p">(</span><span class="nx">jqXHR</span><span class="p">.</span><span class="nx">isResolved</span><span class="p">())</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-31">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-31">&#182;</a></div>
      <p>4825: Get the actual response in case
         a dataFilter is present in ajaxSettings</p></td>
   <td class="code">
      <div class="highlight"><pre>
                  <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
                     <span class="nx">responseText</span> <span class="o">=</span> <span class="nx">r</span><span class="p">;</span>
                  <span class="p">});</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-32">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-32">&#182;</a></div>
      <p>See if a selector was specified</p></td>
   <td class="code">
      <div class="highlight"><pre>
                  <span class="nx">self</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">selector</span> <span class="o">?</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-33">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-33">&#182;</a></div>
      <p>Create a dummy div to hold the results</p></td>
   <td class="code">
      <div class="highlight"><pre>
                        <span class="nx">jQuery</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;&quot;</span><span class="p">)</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-34">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-34">&#182;</a></div>
      <p>inject the contents of the document in, removing the scripts
         to avoid any 'Permission Denied' errors in IE</p></td>
   <td class="code">
      <div class="highlight"><pre>
                              <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">responseText</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">rscript</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-35">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-35">&#182;</a></div>
      <p>Locate the specified elements</p></td>
   <td class="code">
      <div class="highlight"><pre>
                              <span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="o">:</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-36">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-36">&#182;</a></div>
      <p>If not, just inject the full result</p></td>
   <td class="code">
      <div class="highlight"><pre>
                        <span class="nx">responseText</span><span class="p">);</span>
               <span class="p">}</span>

               <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                  <span class="nx">self</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="p">[</span> <span class="nx">responseText</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">jqXHR</span> <span class="p">]);</span>
               <span class="p">}</span>
            <span class="p">}</span>
         <span class="p">});</span>

         <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
      <span class="p">},</span>

      <span class="nx">serialize</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
         <span class="k">return</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">param</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">serializeArray</span><span class="p">());</span>
      <span class="p">},</span>

      <span class="nx">serializeArray</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
         <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">elements</span> <span class="o">?</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">makeArray</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">elements</span><span class="p">)</span> <span class="o">:</span> <span class="k">this</span><span class="p">;</span>
         <span class="p">})</span>
               <span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">disabled</span> <span class="o">&amp;&amp;</span>
                        <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">checked</span> <span class="o">||</span> <span class="nx">rselectTextarea</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">)</span> <span class="o">||</span>
                              <span class="nx">rinput</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">);</span>
               <span class="p">})</span>
               <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">elem</span><span class="p">)</span> <span class="p">{</span>
                  <span class="kd">var</span> <span class="nx">val</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>

                  <span class="k">return</span> <span class="nx">val</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span>
                        <span class="kc">null</span> <span class="o">:</span>
                        <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="o">?</span>
                              <span class="nx">jQuery</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                                 <span class="k">return</span> <span class="p">{</span> <span class="nx">name</span><span class="o">:</span><span class="nx">elem</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span><span class="nx">val</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">rCRLF</span><span class="p">,</span> <span class="s2">&quot;\r\n&quot;</span><span class="p">)</span> <span class="p">};</span>
                              <span class="p">})</span> <span class="o">:</span>
                        <span class="p">{</span> <span class="nx">name</span><span class="o">:</span><span class="nx">elem</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span><span class="nx">val</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">rCRLF</span><span class="p">,</span> <span class="s2">&quot;\r\n&quot;</span><span class="p">)</span> <span class="p">};</span>
               <span class="p">}).</span><span class="nx">get</span><span class="p">();</span>
      <span class="p">}</span>
   <span class="p">});</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-37">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-37">&#182;</a></div>
      <p>Attach a bunch of functions for handling common AJAX events</p></td>
   <td class="code">
      <div class="highlight"><pre>
   <span class="nx">jQuery</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="s2">&quot;ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend&quot;</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span><span class="p">[</span> <span class="nx">o</span> <span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="nx">f</span><span class="p">);</span>
      <span class="p">};</span>
   <span class="p">});</span>

   <span class="nx">jQuery</span><span class="p">.</span><span class="nx">each</span><span class="p">([</span> <span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span> <span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">jQuery</span><span class="p">[</span> <span class="nx">method</span> <span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">type</span><span class="p">)</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-38">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-38">&#182;</a></div>
      <p>shift arguments if data argument was omitted</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">if</span> <span class="p">(</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">type</span> <span class="o">=</span> <span class="nx">type</span> <span class="o">||</span> <span class="nx">callback</span><span class="p">;</span>
            <span class="nx">callback</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
            <span class="nx">data</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
         <span class="p">}</span>

         <span class="k">return</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
            <span class="nx">type</span><span class="o">:</span>    <span class="nx">method</span><span class="p">,</span>
            <span class="nx">url</span><span class="o">:</span>     <span class="nx">url</span><span class="p">,</span>
            <span class="nx">data</span><span class="o">:</span>    <span class="nx">data</span><span class="p">,</span>
            <span class="nx">success</span><span class="o">:</span> <span class="nx">callback</span><span class="p">,</span>
            <span class="nx">dataType</span><span class="o">:</span><span class="nx">type</span>
         <span class="p">});</span>
      <span class="p">};</span>
   <span class="p">});</span>

   <span class="nx">jQuery</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

      <span class="nx">getScript</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">return</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="s2">&quot;script&quot;</span><span class="p">);</span>
      <span class="p">},</span>

      <span class="nx">getJSON</span><span class="o">:</span>  <span class="kd">function</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">return</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="s2">&quot;json&quot;</span><span class="p">);</span>
      <span class="p">},</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-39">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-39">&#182;</a></div>
      <p>Creates a full fledged settings object into target
         with both ajaxSettings and settings fields.
         If target is omitted, writes into ajaxSettings.</p></td>
   <td class="code">
      <div class="highlight"><pre>
      <span class="nx">ajaxSetup</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">if</span> <span class="p">(</span><span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-40">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-40">&#182;</a></div>
      <p>Building a settings object</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="nx">ajaxExtend</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ajaxSettings</span><span class="p">);</span>
         <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-41">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-41">&#182;</a></div>
      <p>Extending ajaxSettings</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="nx">settings</span> <span class="o">=</span> <span class="nx">target</span><span class="p">;</span>
            <span class="nx">target</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ajaxSettings</span><span class="p">;</span>
         <span class="p">}</span>
         <span class="nx">ajaxExtend</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">settings</span><span class="p">);</span>
         <span class="k">return</span> <span class="nx">target</span><span class="p">;</span>
      <span class="p">},</span>

      <span class="nx">ajaxSettings</span><span class="o">:</span><span class="p">{</span>
         <span class="nx">url</span><span class="o">:</span>        <span class="nx">ajaxLocation</span><span class="p">,</span>
         <span class="nx">isLocal</span><span class="o">:</span>    <span class="nx">rlocalProtocol</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">ajaxLocParts</span><span class="p">[</span> <span class="mi">1</span> <span class="p">]),</span>
         <span class="nx">global</span><span class="o">:</span>     <span class="kc">true</span><span class="p">,</span>
         <span class="nx">type</span><span class="o">:</span>       <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
         <span class="nx">contentType</span><span class="o">:</span><span class="s2">&quot;application/x-www-form-urlencoded; charset=UTF-8&quot;</span><span class="p">,</span>
         <span class="nx">processData</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span>
         <span class="nx">async</span><span class="o">:</span>      <span class="kc">true</span><span class="p">,</span>
         <span class="cm">/*</span>
<span class="cm">          timeout: 0,</span>
<span class="cm">          data: null,</span>
<span class="cm">          dataType: null,</span>
<span class="cm">          username: null,</span>
<span class="cm">          password: null,</span>
<span class="cm">          cache: null,</span>
<span class="cm">          traditional: false,</span>
<span class="cm">          headers: {},</span>
<span class="cm">          */</span>

         <span class="nx">accepts</span><span class="o">:</span><span class="p">{</span>
            <span class="nx">xml</span><span class="o">:</span> <span class="s2">&quot;application/xml, text/xml&quot;</span><span class="p">,</span>
            <span class="nx">html</span><span class="o">:</span><span class="s2">&quot;text/html&quot;</span><span class="p">,</span>
            <span class="nx">text</span><span class="o">:</span><span class="s2">&quot;text/plain&quot;</span><span class="p">,</span>
            <span class="nx">json</span><span class="o">:</span><span class="s2">&quot;application/json, text/javascript&quot;</span><span class="p">,</span>
            <span class="s2">&quot;*&quot;</span><span class="o">:</span> <span class="nx">allTypes</span>
         <span class="p">},</span>

         <span class="nx">contents</span><span class="o">:</span><span class="p">{</span>
            <span class="nx">xml</span><span class="o">:</span> <span class="sr">/xml/</span><span class="p">,</span>
            <span class="nx">html</span><span class="o">:</span><span class="sr">/html/</span><span class="p">,</span>
            <span class="nx">json</span><span class="o">:</span><span class="sr">/json/</span>
         <span class="p">},</span>

         <span class="nx">responseFields</span><span class="o">:</span><span class="p">{</span>
            <span class="nx">xml</span><span class="o">:</span> <span class="s2">&quot;responseXML&quot;</span><span class="p">,</span>
            <span class="nx">text</span><span class="o">:</span><span class="s2">&quot;responseText&quot;</span>
         <span class="p">},</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-42">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-42">&#182;</a></div>
      <p>List of data converters
         1) key format is "source<em>type destination</em>type" (a single space in-between)
         2) the catchall symbol "*" can be used for source_type</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">converters</span><span class="o">:</span>    <span class="p">{</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-43">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-43">&#182;</a></div>
      <p>Convert anything to text</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="s2">&quot;* text&quot;</span><span class="o">:</span>   <span class="nb">window</span><span class="p">.</span><span class="nb">String</span><span class="p">,</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-44">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-44">&#182;</a></div>
      <p>Text to html (true = no transformation)</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="s2">&quot;text html&quot;</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-45">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-45">&#182;</a></div>
      <p>Evaluate text as a json expression</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="s2">&quot;text json&quot;</span><span class="o">:</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">parseJSON</span><span class="p">,</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-46">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-46">&#182;</a></div>
      <p>Parse text as xml</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="s2">&quot;text xml&quot;</span><span class="o">:</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">parseXML</span>
         <span class="p">},</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-47">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-47">&#182;</a></div>
      <p>For options that shouldn't be deep extended:
         you can add your own custom options here if
         and when you create one that shouldn't be
         deep extended (see ajaxExtend)</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">flatOptions</span><span class="o">:</span>   <span class="p">{</span>
            <span class="nx">context</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span>
            <span class="nx">url</span><span class="o">:</span>    <span class="kc">true</span>
         <span class="p">}</span>
      <span class="p">},</span>

      <span class="nx">ajaxPrefilter</span><span class="o">:</span><span class="nx">addToPrefiltersOrTransports</span><span class="p">(</span><span class="nx">prefilters</span><span class="p">),</span>
      <span class="nx">ajaxTransport</span><span class="o">:</span><span class="nx">addToPrefiltersOrTransports</span><span class="p">(</span><span class="nx">transports</span><span class="p">),</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-48">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-48">&#182;</a></div>
      <p>Main method</p></td>
   <td class="code">
      <div class="highlight"><pre>
      <span class="nx">ajax</span><span class="o">:</span>         <span class="kd">function</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-49">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-49">&#182;</a></div>
      <p>If url is an object, simulate pre-1.5 signature</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">url</span> <span class="o">===</span> <span class="s2">&quot;object&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">options</span> <span class="o">=</span> <span class="nx">url</span><span class="p">;</span>
            <span class="nx">url</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
         <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-50">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-50">&#182;</a></div>
      <p>Force options to be an object</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{};</span>

         <span class="kd">var</span> <span class="c1">// Create the final options object</span>
               <span class="nx">s</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ajaxSetup</span><span class="p">({},</span> <span class="nx">options</span><span class="p">),</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-51">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-51">&#182;</a></div>
      <p>Callbacks context</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">callbackContext</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">context</span> <span class="o">||</span> <span class="nx">s</span><span class="p">,</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-52">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-52">&#182;</a></div>
      <p>Context for global events
         It's the callbackContext if one was provided in the options
         and if it's a DOM node or a jQuery collection</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">globalEventContext</span> <span class="o">=</span> <span class="nx">callbackContext</span> <span class="o">!==</span> <span class="nx">s</span> <span class="o">&amp;&amp;</span>
                     <span class="p">(</span> <span class="nx">callbackContext</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">||</span> <span class="nx">callbackContext</span> <span class="k">instanceof</span> <span class="nx">jQuery</span> <span class="p">)</span> <span class="o">?</span>
                     <span class="nx">jQuery</span><span class="p">(</span><span class="nx">callbackContext</span><span class="p">)</span> <span class="o">:</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">event</span><span class="p">,</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-53">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-53">&#182;</a></div>
      <p>Deferreds</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">Deferred</span><span class="p">(),</span>
               <span class="nx">completeDeferred</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">Callbacks</span><span class="p">(</span><span class="s2">&quot;once memory&quot;</span><span class="p">),</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-54">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-54">&#182;</a></div>
      <p>Status-dependent callbacks</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">statusCode</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">||</span> <span class="p">{},</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-55">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-55">&#182;</a></div>
      <p>ifModified key</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">ifModifiedKey</span><span class="p">,</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-56">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-56">&#182;</a></div>
      <p>Headers (they are sent all at once)</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">requestHeaders</span> <span class="o">=</span> <span class="p">{},</span>
               <span class="nx">requestHeadersNames</span> <span class="o">=</span> <span class="p">{},</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-57">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-57">&#182;</a></div>
      <p>Response headers</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">responseHeadersString</span><span class="p">,</span>
               <span class="nx">responseHeaders</span><span class="p">,</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-58">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-58">&#182;</a></div>
      <p>transport</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">transport</span><span class="p">,</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-59">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-59">&#182;</a></div>
      <p>timeout handle</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">timeoutTimer</span><span class="p">,</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-60">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-60">&#182;</a></div>
      <p>Cross-domain detection vars</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">parts</span><span class="p">,</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-61">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-61">&#182;</a></div>
      <p>The jqXHR state</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-62">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-62">&#182;</a></div>
      <p>To know if global events are to be dispatched</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">fireGlobals</span><span class="p">,</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-63">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-63">&#182;</a></div>
      <p>Loop variable</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">i</span><span class="p">,</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-64">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-64">&#182;</a></div>
      <p>Fake xhr</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">jqXHR</span> <span class="o">=</span> <span class="p">{</span>

                  <span class="nx">readyState</span><span class="o">:</span>           <span class="mi">0</span><span class="p">,</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-65">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-65">&#182;</a></div>
      <p>Caches the header</p></td>
   <td class="code">
      <div class="highlight"><pre>
                  <span class="nx">setRequestHeader</span><span class="o">:</span>     <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
                     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
                        <span class="kd">var</span> <span class="nx">lname</span> <span class="o">=</span> <span class="nx">name</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
                        <span class="nx">name</span> <span class="o">=</span> <span class="nx">requestHeadersNames</span><span class="p">[</span> <span class="nx">lname</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">requestHeadersNames</span><span class="p">[</span> <span class="nx">lname</span> <span class="p">]</span> <span class="o">||</span> <span class="nx">name</span><span class="p">;</span>
                        <span class="nx">requestHeaders</span><span class="p">[</span> <span class="nx">name</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
                     <span class="p">}</span>
                     <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
                  <span class="p">},</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-66">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-66">&#182;</a></div>
      <p>Raw string</p></td>
   <td class="code">
      <div class="highlight"><pre>
                  <span class="nx">getAllResponseHeaders</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                     <span class="k">return</span> <span class="nx">state</span> <span class="o">===</span> <span class="mi">2</span> <span class="o">?</span> <span class="nx">responseHeadersString</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>
                  <span class="p">},</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-67">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-67">&#182;</a></div>
      <p>Builds headers hashtable if needed</p></td>
   <td class="code">
      <div class="highlight"><pre>
                  <span class="nx">getResponseHeader</span><span class="o">:</span>    <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
                     <span class="kd">var</span> <span class="nx">match</span><span class="p">;</span>
                     <span class="k">if</span> <span class="p">(</span><span class="nx">state</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">responseHeaders</span><span class="p">)</span> <span class="p">{</span>
                           <span class="nx">responseHeaders</span> <span class="o">=</span> <span class="p">{};</span>
                           <span class="k">while</span> <span class="p">((</span> <span class="nx">match</span> <span class="o">=</span> <span class="nx">rheaders</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">responseHeadersString</span><span class="p">)</span> <span class="p">))</span> <span class="p">{</span>
                              <span class="nx">responseHeaders</span><span class="p">[</span> <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">match</span><span class="p">[</span> <span class="mi">2</span> <span class="p">];</span>
                           <span class="p">}</span>
                        <span class="p">}</span>
                        <span class="nx">match</span> <span class="o">=</span> <span class="nx">responseHeaders</span><span class="p">[</span> <span class="nx">key</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="p">];</span>
                     <span class="p">}</span>
                     <span class="k">return</span> <span class="nx">match</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="nx">match</span><span class="p">;</span>
                  <span class="p">},</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-68">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-68">&#182;</a></div>
      <p>Overrides response content-type header</p></td>
   <td class="code">
      <div class="highlight"><pre>
                  <span class="nx">overrideMimeType</span><span class="o">:</span>     <span class="kd">function</span><span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
                     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">s</span><span class="p">.</span><span class="nx">mimeType</span> <span class="o">=</span> <span class="nx">type</span><span class="p">;</span>
                     <span class="p">}</span>
                     <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
                  <span class="p">},</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-69">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-69">&#182;</a></div>
      <p>Cancel the request</p></td>
   <td class="code">
      <div class="highlight"><pre>
                  <span class="nx">abort</span><span class="o">:</span>                <span class="kd">function</span><span class="p">(</span><span class="nx">statusText</span><span class="p">)</span> <span class="p">{</span>
                     <span class="nx">statusText</span> <span class="o">=</span> <span class="nx">statusText</span> <span class="o">||</span> <span class="s2">&quot;abort&quot;</span><span class="p">;</span>
                     <span class="k">if</span> <span class="p">(</span><span class="nx">transport</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">transport</span><span class="p">.</span><span class="nx">abort</span><span class="p">(</span><span class="nx">statusText</span><span class="p">);</span>
                     <span class="p">}</span>
                     <span class="nx">done</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">statusText</span><span class="p">);</span>
                     <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
                  <span class="p">}</span>
               <span class="p">};</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-70">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-70">&#182;</a></div>
      <p>Callback for when everything is done
         It is defined here because jslint complains if it is declared
         at the end of the function (which would be more logical and readable)</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="kd">function</span> <span class="nx">done</span><span class="p">(</span><span class="nx">status</span><span class="p">,</span> <span class="nx">nativeStatusText</span><span class="p">,</span> <span class="nx">responses</span><span class="p">,</span> <span class="nx">headers</span><span class="p">)</span> <span class="p">{</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-71">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-71">&#182;</a></div>
      <p>Called once</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">state</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-72">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-72">&#182;</a></div>
      <p>State is "done" now</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="nx">state</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-73">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-73">&#182;</a></div>
      <p>Clear timeout if it exists</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">timeoutTimer</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">timeoutTimer</span><span class="p">);</span>
            <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-74">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-74">&#182;</a></div>
      <p>Dereference transport for early garbage collection
         (no matter how long the jqXHR object will be used)</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="nx">transport</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-75">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-75">&#182;</a></div>
      <p>Cache response headers</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="nx">responseHeadersString</span> <span class="o">=</span> <span class="nx">headers</span> <span class="o">||</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-76">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-76">&#182;</a></div>
      <p>Set readyState</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">=</span> <span class="nx">status</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">4</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>

            <span class="kd">var</span> <span class="nx">isSuccess</span><span class="p">,</span>
                  <span class="nx">success</span><span class="p">,</span>
                  <span class="nx">error</span><span class="p">,</span>
                  <span class="nx">statusText</span> <span class="o">=</span> <span class="nx">nativeStatusText</span><span class="p">,</span>
                  <span class="nx">response</span> <span class="o">=</span> <span class="nx">responses</span> <span class="o">?</span> <span class="nx">ajaxHandleResponses</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">jqXHR</span><span class="p">,</span> <span class="nx">responses</span><span class="p">)</span> <span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span>
                  <span class="nx">lastModified</span><span class="p">,</span>
                  <span class="nx">etag</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-77">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-77">&#182;</a></div>
      <p>If successful, handle type chaining</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">status</span> <span class="o">&gt;=</span> <span class="mi">200</span> <span class="o">&amp;&amp;</span> <span class="nx">status</span> <span class="o">&lt;</span> <span class="mi">300</span> <span class="o">||</span> <span class="nx">status</span> <span class="o">===</span> <span class="mi">304</span><span class="p">)</span> <span class="p">{</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-78">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-78">&#182;</a></div>
      <p>Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">ifModified</span><span class="p">)</span> <span class="p">{</span>

                  <span class="k">if</span> <span class="p">((</span> <span class="nx">lastModified</span> <span class="o">=</span> <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">(</span><span class="s2">&quot;Last-Modified&quot;</span><span class="p">)</span> <span class="p">))</span> <span class="p">{</span>
                     <span class="nx">jQuery</span><span class="p">.</span><span class="nx">lastModified</span><span class="p">[</span> <span class="nx">ifModifiedKey</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">lastModified</span><span class="p">;</span>
                  <span class="p">}</span>
                  <span class="k">if</span> <span class="p">((</span> <span class="nx">etag</span> <span class="o">=</span> <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">(</span><span class="s2">&quot;Etag&quot;</span><span class="p">)</span> <span class="p">))</span> <span class="p">{</span>
                     <span class="nx">jQuery</span><span class="p">.</span><span class="nx">etag</span><span class="p">[</span> <span class="nx">ifModifiedKey</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">etag</span><span class="p">;</span>
                  <span class="p">}</span>
               <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-79">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-79">&#182;</a></div>
      <p>If not modified</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="k">if</span> <span class="p">(</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">304</span><span class="p">)</span> <span class="p">{</span>

                  <span class="nx">statusText</span> <span class="o">=</span> <span class="s2">&quot;notmodified&quot;</span><span class="p">;</span>
                  <span class="nx">isSuccess</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-80">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-80">&#182;</a></div>
      <p>If we have data</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

                  <span class="k">try</span> <span class="p">{</span>
                     <span class="nx">success</span> <span class="o">=</span> <span class="nx">ajaxConvert</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">response</span><span class="p">);</span>
                     <span class="nx">statusText</span> <span class="o">=</span> <span class="s2">&quot;success&quot;</span><span class="p">;</span>
                     <span class="nx">isSuccess</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-81">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-81">&#182;</a></div>
      <p>We have a parsererror</p></td>
   <td class="code">
      <div class="highlight"><pre>
                     <span class="nx">statusText</span> <span class="o">=</span> <span class="s2">&quot;parsererror&quot;</span><span class="p">;</span>
                     <span class="nx">error</span> <span class="o">=</span> <span class="nx">e</span><span class="p">;</span>
                  <span class="p">}</span>
               <span class="p">}</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-82">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-82">&#182;</a></div>
      <p>We extract error from statusText
         then normalize statusText and status for non-aborts</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">error</span> <span class="o">=</span> <span class="nx">statusText</span><span class="p">;</span>
               <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">statusText</span> <span class="o">||</span> <span class="nx">status</span><span class="p">)</span> <span class="p">{</span>
                  <span class="nx">statusText</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span><span class="p">;</span>
                  <span class="k">if</span> <span class="p">(</span><span class="nx">status</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                     <span class="nx">status</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                  <span class="p">}</span>
               <span class="p">}</span>
            <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-83">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-83">&#182;</a></div>
      <p>Set data for the fake xhr object</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="nx">status</span><span class="p">;</span>
            <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">statusText</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="o">+</span> <span class="p">(</span> <span class="nx">nativeStatusText</span> <span class="o">||</span> <span class="nx">statusText</span> <span class="p">);</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-84">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-84">&#182;</a></div>
      <p>Success/Error</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">isSuccess</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">deferred</span><span class="p">.</span><span class="nx">resolveWith</span><span class="p">(</span><span class="nx">callbackContext</span><span class="p">,</span> <span class="p">[</span> <span class="nx">success</span><span class="p">,</span> <span class="nx">statusText</span><span class="p">,</span> <span class="nx">jqXHR</span> <span class="p">]);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
               <span class="nx">deferred</span><span class="p">.</span><span class="nx">rejectWith</span><span class="p">(</span><span class="nx">callbackContext</span><span class="p">,</span> <span class="p">[</span> <span class="nx">jqXHR</span><span class="p">,</span> <span class="nx">statusText</span><span class="p">,</span> <span class="nx">error</span> <span class="p">]);</span>
            <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-85">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-85">&#182;</a></div>
      <p>Status-dependent callbacks</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">(</span><span class="nx">statusCode</span><span class="p">);</span>
            <span class="nx">statusCode</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">fireGlobals</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">globalEventContext</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;ajax&quot;</span> <span class="o">+</span> <span class="p">(</span> <span class="nx">isSuccess</span> <span class="o">?</span> <span class="s2">&quot;Success&quot;</span> <span class="o">:</span> <span class="s2">&quot;Error&quot;</span> <span class="p">),</span>
                     <span class="p">[</span> <span class="nx">jqXHR</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">isSuccess</span> <span class="o">?</span> <span class="nx">success</span> <span class="o">:</span> <span class="nx">error</span> <span class="p">]);</span>
            <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-86">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-86">&#182;</a></div>
      <p>Complete</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="nx">completeDeferred</span><span class="p">.</span><span class="nx">fireWith</span><span class="p">(</span><span class="nx">callbackContext</span><span class="p">,</span> <span class="p">[</span> <span class="nx">jqXHR</span><span class="p">,</span> <span class="nx">statusText</span> <span class="p">]);</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">fireGlobals</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">globalEventContext</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;ajaxComplete&quot;</span><span class="p">,</span> <span class="p">[</span> <span class="nx">jqXHR</span><span class="p">,</span> <span class="nx">s</span> <span class="p">]);</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-87">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-87">&#182;</a></div>
      <p>Handle the global AJAX counter</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span> <span class="o">--</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">active</span> <span class="p">))</span> <span class="p">{</span>
                  <span class="nx">jQuery</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;ajaxStop&quot;</span><span class="p">);</span>
               <span class="p">}</span>
            <span class="p">}</span>
         <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-88">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-88">&#182;</a></div>
      <p>Attach deferreds</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">deferred</span><span class="p">.</span><span class="nx">promise</span><span class="p">(</span><span class="nx">jqXHR</span><span class="p">);</span>
         <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">success</span> <span class="o">=</span> <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">done</span><span class="p">;</span>
         <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">fail</span><span class="p">;</span>
         <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">complete</span> <span class="o">=</span> <span class="nx">completeDeferred</span><span class="p">.</span><span class="nx">add</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-89">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-89">&#182;</a></div>
      <p>Status-dependent callbacks</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">map</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">map</span><span class="p">)</span> <span class="p">{</span>
               <span class="kd">var</span> <span class="nx">tmp</span><span class="p">;</span>
               <span class="k">if</span> <span class="p">(</span><span class="nx">state</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                  <span class="k">for</span> <span class="p">(</span><span class="nx">tmp</span> <span class="k">in</span> <span class="nx">map</span><span class="p">)</span> <span class="p">{</span>
                     <span class="nx">statusCode</span><span class="p">[</span> <span class="nx">tmp</span> <span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="nx">statusCode</span><span class="p">[</span><span class="nx">tmp</span><span class="p">],</span> <span class="nx">map</span><span class="p">[</span><span class="nx">tmp</span><span class="p">]</span> <span class="p">];</span>
                  <span class="p">}</span>
               <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                  <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">map</span><span class="p">[</span> <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">status</span> <span class="p">];</span>
                  <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">tmp</span><span class="p">,</span> <span class="nx">tmp</span><span class="p">);</span>
               <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
         <span class="p">};</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-90">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-90">&#182;</a></div>
      <p>Remove hash character (#7531: and string promotion)
         Add protocol if not provided (#5866: IE7 issue with protocol-less urls)
         We also use the url parameter if available</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">s</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span> <span class="nx">url</span> <span class="o">||</span> <span class="nx">s</span><span class="p">.</span><span class="nx">url</span> <span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span> <span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">rhash</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">rprotocol</span><span class="p">,</span> <span class="nx">ajaxLocParts</span><span class="p">[</span> <span class="mi">1</span> <span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;//&quot;</span><span class="p">);</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-91">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-91">&#182;</a></div>
      <p>Extract dataTypes list</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">s</span><span class="p">.</span><span class="nx">dataTypes</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">dataType</span> <span class="o">||</span> <span class="s2">&quot;*&quot;</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">split</span><span class="p">(</span><span class="nx">rspacesAjax</span><span class="p">);</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-92">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-92">&#182;</a></div>
      <p>Determine if a cross-domain request is in order</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">crossDomain</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">parts</span> <span class="o">=</span> <span class="nx">rurl</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">());</span>
            <span class="nx">s</span><span class="p">.</span><span class="nx">crossDomain</span> <span class="o">=</span> <span class="o">!!</span><span class="p">(</span> <span class="nx">parts</span> <span class="o">&amp;&amp;</span>
                  <span class="p">(</span> <span class="nx">parts</span><span class="p">[</span> <span class="mi">1</span> <span class="p">]</span> <span class="o">!=</span> <span class="nx">ajaxLocParts</span><span class="p">[</span> <span class="mi">1</span> <span class="p">]</span> <span class="o">||</span> <span class="nx">parts</span><span class="p">[</span> <span class="mi">2</span> <span class="p">]</span> <span class="o">!=</span> <span class="nx">ajaxLocParts</span><span class="p">[</span> <span class="mi">2</span> <span class="p">]</span> <span class="o">||</span>
                        <span class="p">(</span> <span class="nx">parts</span><span class="p">[</span> <span class="mi">3</span> <span class="p">]</span> <span class="o">||</span> <span class="p">(</span> <span class="nx">parts</span><span class="p">[</span> <span class="mi">1</span> <span class="p">]</span> <span class="o">===</span> <span class="s2">&quot;http:&quot;</span> <span class="o">?</span> <span class="mi">80</span> <span class="o">:</span> <span class="mi">443</span> <span class="p">)</span> <span class="p">)</span> <span class="o">!=</span>
                              <span class="p">(</span> <span class="nx">ajaxLocParts</span><span class="p">[</span> <span class="mi">3</span> <span class="p">]</span> <span class="o">||</span> <span class="p">(</span> <span class="nx">ajaxLocParts</span><span class="p">[</span> <span class="mi">1</span> <span class="p">]</span> <span class="o">===</span> <span class="s2">&quot;http:&quot;</span> <span class="o">?</span> <span class="mi">80</span> <span class="o">:</span> <span class="mi">443</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
                  <span class="p">);</span>
         <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-93">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-93">&#182;</a></div>
      <p>Convert data if not already a string</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">processData</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">s</span><span class="p">.</span><span class="nx">data</span> <span class="o">!==</span> <span class="s2">&quot;string&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">s</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">param</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">s</span><span class="p">.</span><span class="nx">traditional</span><span class="p">);</span>
         <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-94">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-94">&#182;</a></div>
      <p>Apply prefilters</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">inspectPrefiltersOrTransports</span><span class="p">(</span><span class="nx">prefilters</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">jqXHR</span><span class="p">);</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-95">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-95">&#182;</a></div>
      <p>If request was aborted inside a prefilter, stop there</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">if</span> <span class="p">(</span><span class="nx">state</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
         <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-96">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-96">&#182;</a></div>
      <p>We can fire global events as of now if asked to</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">fireGlobals</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">global</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-97">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-97">&#182;</a></div>
      <p>Uppercase the type</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">s</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-98">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-98">&#182;</a></div>
      <p>Determine if request has content</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">s</span><span class="p">.</span><span class="nx">hasContent</span> <span class="o">=</span> <span class="o">!</span><span class="nx">rnoContent</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-99">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-99">&#182;</a></div>
      <p>Watch for a new set of requests</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">if</span> <span class="p">(</span><span class="nx">fireGlobals</span> <span class="o">&amp;&amp;</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">active</span><span class="o">++</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">jQuery</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;ajaxStart&quot;</span><span class="p">);</span>
         <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-100">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-100">&#182;</a></div>
      <p>More options handling for requests with no content</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">s</span><span class="p">.</span><span class="nx">hasContent</span><span class="p">)</span> <span class="p">{</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-101">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-101">&#182;</a></div>
      <p>If data is available, append data to url</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">s</span><span class="p">.</span><span class="nx">url</span> <span class="o">+=</span> <span class="p">(</span> <span class="nx">rquery</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">url</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;&amp;&quot;</span> <span class="o">:</span> <span class="s2">&quot;?&quot;</span> <span class="p">)</span> <span class="o">+</span> <span class="nx">s</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-102">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-102">&#182;</a></div>
      <p>9682: remove data so that it's not used in an eventual retry</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="k">delete</span> <span class="nx">s</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
            <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-103">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-103">&#182;</a></div>
      <p>Get ifModifiedKey before adding the anti-cache parameter</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="nx">ifModifiedKey</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">url</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-104">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-104">&#182;</a></div>
      <p>Add anti-cache in url if needed</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">cache</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>

               <span class="kd">var</span> <span class="nx">ts</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-105">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-105">&#182;</a></div>
      <p>try replacing _= if it is there</p></td>
   <td class="code">
      <div class="highlight"><pre>
                     <span class="nx">ret</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">rts</span><span class="p">,</span> <span class="s2">&quot;$1_=&quot;</span> <span class="o">+</span> <span class="nx">ts</span><span class="p">);</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-106">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-106">&#182;</a></div>
      <p>if nothing was replaced, add timestamp to the end</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">s</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="nx">ret</span> <span class="o">+</span> <span class="p">(</span> <span class="p">(</span> <span class="nx">ret</span> <span class="o">===</span> <span class="nx">s</span><span class="p">.</span><span class="nx">url</span> <span class="p">)</span> <span class="o">?</span> <span class="p">(</span> <span class="nx">rquery</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">url</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;&amp;&quot;</span> <span class="o">:</span> <span class="s2">&quot;?&quot;</span> <span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_=&quot;</span> <span class="o">+</span> <span class="nx">ts</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span> <span class="p">);</span>
            <span class="p">}</span>
         <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-107">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-107">&#182;</a></div>
      <p>Set the correct header, if data is being sent</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">hasContent</span> <span class="o">&amp;&amp;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">contentType</span> <span class="o">!==</span> <span class="kc">false</span> <span class="o">||</span> <span class="nx">options</span><span class="p">.</span><span class="nx">contentType</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="nx">s</span><span class="p">.</span><span class="nx">contentType</span><span class="p">);</span>
         <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-108">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-108">&#182;</a></div>
      <p>Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">ifModified</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">ifModifiedKey</span> <span class="o">=</span> <span class="nx">ifModifiedKey</span> <span class="o">||</span> <span class="nx">s</span><span class="p">.</span><span class="nx">url</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">lastModified</span><span class="p">[</span> <span class="nx">ifModifiedKey</span> <span class="p">])</span> <span class="p">{</span>
               <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="s2">&quot;If-Modified-Since&quot;</span><span class="p">,</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">lastModified</span><span class="p">[</span> <span class="nx">ifModifiedKey</span> <span class="p">]);</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">etag</span><span class="p">[</span> <span class="nx">ifModifiedKey</span> <span class="p">])</span> <span class="p">{</span>
               <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="s2">&quot;If-None-Match&quot;</span><span class="p">,</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">etag</span><span class="p">[</span> <span class="nx">ifModifiedKey</span> <span class="p">]);</span>
            <span class="p">}</span>
         <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-109">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-109">&#182;</a></div>
      <p>Set the Accepts header for the server, depending on the dataType</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span>
               <span class="s2">&quot;Accept&quot;</span><span class="p">,</span>
               <span class="nx">s</span><span class="p">.</span><span class="nx">dataTypes</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">accepts</span><span class="p">[</span> <span class="nx">s</span><span class="p">.</span><span class="nx">dataTypes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">]</span> <span class="o">?</span>
                     <span class="nx">s</span><span class="p">.</span><span class="nx">accepts</span><span class="p">[</span> <span class="nx">s</span><span class="p">.</span><span class="nx">dataTypes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">]</span> <span class="o">+</span> <span class="p">(</span> <span class="nx">s</span><span class="p">.</span><span class="nx">dataTypes</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="o">!==</span> <span class="s2">&quot;*&quot;</span> <span class="o">?</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="nx">allTypes</span> <span class="o">+</span> <span class="s2">&quot;; q=0.01&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span> <span class="p">)</span> <span class="o">:</span>
                     <span class="nx">s</span><span class="p">.</span><span class="nx">accepts</span><span class="p">[</span> <span class="s2">&quot;*&quot;</span> <span class="p">]</span>
         <span class="p">);</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-110">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-110">&#182;</a></div>
      <p>Check for headers option</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">s</span><span class="p">.</span><span class="nx">headers</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">s</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span> <span class="nx">i</span> <span class="p">]);</span>
         <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-111">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-111">&#182;</a></div>
      <p>Allow custom headers/mimetypes and early abort</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">beforeSend</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="nx">s</span><span class="p">.</span><span class="nx">beforeSend</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">callbackContext</span><span class="p">,</span> <span class="nx">jqXHR</span><span class="p">,</span> <span class="nx">s</span><span class="p">)</span> <span class="o">===</span> <span class="kc">false</span> <span class="o">||</span> <span class="nx">state</span> <span class="o">===</span> <span class="mi">2</span> <span class="p">))</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-112">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-112">&#182;</a></div>
      <p>Abort if not done already</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">abort</span><span class="p">();</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>

         <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-113">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-113">&#182;</a></div>
      <p>Install callbacks on deferreds</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="p">{</span> <span class="nx">success</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span> <span class="nx">error</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span> <span class="nx">complete</span><span class="o">:</span><span class="mi">1</span> <span class="p">})</span> <span class="p">{</span>
            <span class="nx">jqXHR</span><span class="p">[</span> <span class="nx">i</span> <span class="p">](</span><span class="nx">s</span><span class="p">[</span> <span class="nx">i</span> <span class="p">]);</span>
         <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-114">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-114">&#182;</a></div>
      <p>Get transport</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">transport</span> <span class="o">=</span> <span class="nx">inspectPrefiltersOrTransports</span><span class="p">(</span><span class="nx">transports</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">jqXHR</span><span class="p">);</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-115">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-115">&#182;</a></div>
      <p>If no transport, we auto-abort</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">transport</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">done</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;No Transport&quot;</span><span class="p">);</span>
         <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-116">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-116">&#182;</a></div>
      <p>Send global event</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">fireGlobals</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">globalEventContext</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;ajaxSend&quot;</span><span class="p">,</span> <span class="p">[</span> <span class="nx">jqXHR</span><span class="p">,</span> <span class="nx">s</span> <span class="p">]);</span>
            <span class="p">}</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-117">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-117">&#182;</a></div>
      <p>Timeout</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">async</span> <span class="o">&amp;&amp;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">timeout</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">timeoutTimer</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                  <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">abort</span><span class="p">(</span><span class="s2">&quot;timeout&quot;</span><span class="p">);</span>
               <span class="p">},</span> <span class="nx">s</span><span class="p">.</span><span class="nx">timeout</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="k">try</span> <span class="p">{</span>
               <span class="nx">state</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
               <span class="nx">transport</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">requestHeaders</span><span class="p">,</span> <span class="nx">done</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-118">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-118">&#182;</a></div>
      <p>Propagate exception as error if not done</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="k">if</span> <span class="p">(</span><span class="nx">state</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                  <span class="nx">done</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">e</span><span class="p">);</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-119">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-119">&#182;</a></div>
      <p>Simply rethrow otherwise</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                  <span class="k">throw</span> <span class="nx">e</span><span class="p">;</span>
               <span class="p">}</span>
            <span class="p">}</span>
         <span class="p">}</span>

         <span class="k">return</span> <span class="nx">jqXHR</span><span class="p">;</span>
      <span class="p">},</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-120">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-120">&#182;</a></div>
      <p>Serialize an array of form elements or a set of
         key/values into a query string</p></td>
   <td class="code">
      <div class="highlight"><pre>
      <span class="nx">param</span><span class="o">:</span>        <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">traditional</span><span class="p">)</span> <span class="p">{</span>
         <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="p">[],</span>
               <span class="nx">add</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-121">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-121">&#182;</a></div>
      <p>If value is a function, invoke it and return its value</p></td>
   <td class="code">
      <div class="highlight"><pre>
                  <span class="nx">value</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">?</span> <span class="nx">value</span><span class="p">()</span> <span class="o">:</span> <span class="nx">value</span><span class="p">;</span>
                  <span class="nx">s</span><span class="p">[</span> <span class="nx">s</span><span class="p">.</span><span class="nx">length</span> <span class="p">]</span> <span class="o">=</span> <span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">+</span> <span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
               <span class="p">};</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-122">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-122">&#182;</a></div>
      <p>Set traditional to true for jQuery &lt;= 1.3.2 behavior.</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">if</span> <span class="p">(</span><span class="nx">traditional</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">traditional</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ajaxSettings</span><span class="p">.</span><span class="nx">traditional</span><span class="p">;</span>
         <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-123">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-123">&#182;</a></div>
      <p>If an array was passed in, assume that it is an array of form elements.</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">if</span> <span class="p">(</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span> <span class="nx">a</span><span class="p">.</span><span class="nx">jquery</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">isPlainObject</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">))</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-124">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-124">&#182;</a></div>
      <p>Serialize the form elements</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="nx">jQuery</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
               <span class="nx">add</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
            <span class="p">});</span>

         <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-125">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-125">&#182;</a></div>
      <p>If traditional, encode the "old" way (the way 1.3.2 or older
         did it), otherwise encode params recursively.</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">prefix</span> <span class="k">in</span> <span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">buildParams</span><span class="p">(</span><span class="nx">prefix</span><span class="p">,</span> <span class="nx">a</span><span class="p">[</span> <span class="nx">prefix</span> <span class="p">],</span> <span class="nx">traditional</span><span class="p">,</span> <span class="nx">add</span><span class="p">);</span>
            <span class="p">}</span>
         <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-126">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-126">&#182;</a></div>
      <p>Return the resulting serialization</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">return</span> <span class="nx">s</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">r20</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">);</span>
      <span class="p">}</span>
   <span class="p">});</span>

   <span class="kd">function</span> <span class="nx">buildParams</span><span class="p">(</span><span class="nx">prefix</span><span class="p">,</span> <span class="nx">obj</span><span class="p">,</span> <span class="nx">traditional</span><span class="p">,</span> <span class="nx">add</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">obj</span><span class="p">))</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-127">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-127">&#182;</a></div>
      <p>Serialize array item.</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">jQuery</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">v</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">traditional</span> <span class="o">||</span> <span class="nx">rbracket</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">prefix</span><span class="p">))</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-128">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-128">&#182;</a></div>
      <p>Treat each array item as a scalar.</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">add</span><span class="p">(</span><span class="nx">prefix</span><span class="p">,</span> <span class="nx">v</span><span class="p">);</span>

            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-129">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-129">&#182;</a></div>
      <p>If array item is non-scalar (array or object), encode its
         numeric index to resolve deserialization ambiguity issues.
         Note that rack (as of 1.0.0) can't currently deserialize
         nested arrays properly, and attempting to do so may cause
         a server error. Possible fixes are to modify rack's
         deserialization algorithm or to provide an option or flag
         to force array serialization to be shallow.</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">buildParams</span><span class="p">(</span><span class="nx">prefix</span> <span class="o">+</span> <span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="p">(</span> <span class="k">typeof</span> <span class="nx">v</span> <span class="o">===</span> <span class="s2">&quot;object&quot;</span> <span class="o">?</span> <span class="nx">i</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span> <span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="nx">v</span><span class="p">,</span> <span class="nx">traditional</span><span class="p">,</span> <span class="nx">add</span><span class="p">);</span>
            <span class="p">}</span>
         <span class="p">});</span>

      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">traditional</span> <span class="o">&amp;&amp;</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;object&quot;</span><span class="p">)</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-130">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-130">&#182;</a></div>
      <p>Serialize object item.</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">name</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">buildParams</span><span class="p">(</span><span class="nx">prefix</span> <span class="o">+</span> <span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="nx">obj</span><span class="p">[</span> <span class="nx">name</span> <span class="p">],</span> <span class="nx">traditional</span><span class="p">,</span> <span class="nx">add</span><span class="p">);</span>
         <span class="p">}</span>

      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-131">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-131">&#182;</a></div>
      <p>Serialize scalar item.</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">add</span><span class="p">(</span><span class="nx">prefix</span><span class="p">,</span> <span class="nx">obj</span><span class="p">);</span>
      <span class="p">}</span>
   <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-132">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-132">&#182;</a></div>
      <p>This is still on the jQuery object... for now
         Want to move this to jQuery.ajax some day</p></td>
   <td class="code">
      <div class="highlight"><pre>
   <span class="nx">jQuery</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-133">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-133">&#182;</a></div>
      <p>Counter for holding the number of active queries</p></td>
   <td class="code">
      <div class="highlight"><pre>
      <span class="nx">active</span><span class="o">:</span>      <span class="mi">0</span><span class="p">,</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-134">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-134">&#182;</a></div>
      <p>Last-Modified header cache for next request</p></td>
   <td class="code">
      <div class="highlight"><pre>
      <span class="nx">lastModified</span><span class="o">:</span><span class="p">{},</span>
      <span class="nx">etag</span><span class="o">:</span>        <span class="p">{}</span>

   <span class="p">});</span>

   <span class="cm">/* Handles responses to an ajax request:</span>
<span class="cm">    * - sets all responseXXX fields accordingly</span>
<span class="cm">    * - finds the right dataType (mediates between content-type and expected dataType)</span>
<span class="cm">    * - returns the corresponding response</span>
<span class="cm">    */</span>
   <span class="kd">function</span> <span class="nx">ajaxHandleResponses</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">jqXHR</span><span class="p">,</span> <span class="nx">responses</span><span class="p">)</span> <span class="p">{</span>

      <span class="kd">var</span> <span class="nx">contents</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">contents</span><span class="p">,</span>
            <span class="nx">dataTypes</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">dataTypes</span><span class="p">,</span>
            <span class="nx">responseFields</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">responseFields</span><span class="p">,</span>
            <span class="nx">ct</span><span class="p">,</span>
            <span class="nx">type</span><span class="p">,</span>
            <span class="nx">finalDataType</span><span class="p">,</span>
            <span class="nx">firstDataType</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-135">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-135">&#182;</a></div>
      <p>Fill responseXXX fields</p></td>
   <td class="code">
      <div class="highlight"><pre>
      <span class="k">for</span> <span class="p">(</span><span class="nx">type</span> <span class="k">in</span> <span class="nx">responseFields</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="k">in</span> <span class="nx">responses</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">jqXHR</span><span class="p">[</span> <span class="nx">responseFields</span><span class="p">[</span><span class="nx">type</span><span class="p">]</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">responses</span><span class="p">[</span> <span class="nx">type</span> <span class="p">];</span>
         <span class="p">}</span>
      <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-136">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-136">&#182;</a></div>
      <p>Remove auto dataType and get content-type in the process</p></td>
   <td class="code">
      <div class="highlight"><pre>
      <span class="k">while</span> <span class="p">(</span><span class="nx">dataTypes</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="o">===</span> <span class="s2">&quot;*&quot;</span><span class="p">)</span> <span class="p">{</span>
         <span class="nx">dataTypes</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
         <span class="k">if</span> <span class="p">(</span><span class="nx">ct</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">ct</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">mimeType</span> <span class="o">||</span> <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">(</span><span class="s2">&quot;content-type&quot;</span><span class="p">);</span>
         <span class="p">}</span>
      <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-137">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-137">&#182;</a></div>
      <p>Check if we're dealing with a known content-type</p></td>
   <td class="code">
      <div class="highlight"><pre>
      <span class="k">if</span> <span class="p">(</span><span class="nx">ct</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">for</span> <span class="p">(</span><span class="nx">type</span> <span class="k">in</span> <span class="nx">contents</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">contents</span><span class="p">[</span> <span class="nx">type</span> <span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">contents</span><span class="p">[</span> <span class="nx">type</span> <span class="p">].</span><span class="nx">test</span><span class="p">(</span><span class="nx">ct</span><span class="p">))</span> <span class="p">{</span>
               <span class="nx">dataTypes</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">type</span><span class="p">);</span>
               <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
         <span class="p">}</span>
      <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-138">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-138">&#182;</a></div>
      <p>Check to see if we have a response for the expected dataType</p></td>
   <td class="code">
      <div class="highlight"><pre>
      <span class="k">if</span> <span class="p">(</span><span class="nx">dataTypes</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="k">in</span> <span class="nx">responses</span><span class="p">)</span> <span class="p">{</span>
         <span class="nx">finalDataType</span> <span class="o">=</span> <span class="nx">dataTypes</span><span class="p">[</span> <span class="mi">0</span> <span class="p">];</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-139">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-139">&#182;</a></div>
      <p>Try convertible dataTypes</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">for</span> <span class="p">(</span><span class="nx">type</span> <span class="k">in</span> <span class="nx">responses</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">dataTypes</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="o">||</span> <span class="nx">s</span><span class="p">.</span><span class="nx">converters</span><span class="p">[</span> <span class="nx">type</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">dataTypes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">])</span> <span class="p">{</span>
               <span class="nx">finalDataType</span> <span class="o">=</span> <span class="nx">type</span><span class="p">;</span>
               <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">firstDataType</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">firstDataType</span> <span class="o">=</span> <span class="nx">type</span><span class="p">;</span>
            <span class="p">}</span>
         <span class="p">}</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-140">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-140">&#182;</a></div>
      <p>Or just use first one</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">finalDataType</span> <span class="o">=</span> <span class="nx">finalDataType</span> <span class="o">||</span> <span class="nx">firstDataType</span><span class="p">;</span>
      <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-141">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-141">&#182;</a></div>
      <p>If we found a dataType
         We add the dataType to the list if needed
         and return the corresponding response</p></td>
   <td class="code">
      <div class="highlight"><pre>
      <span class="k">if</span> <span class="p">(</span><span class="nx">finalDataType</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">if</span> <span class="p">(</span><span class="nx">finalDataType</span> <span class="o">!==</span> <span class="nx">dataTypes</span><span class="p">[</span> <span class="mi">0</span> <span class="p">])</span> <span class="p">{</span>
            <span class="nx">dataTypes</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">finalDataType</span><span class="p">);</span>
         <span class="p">}</span>
         <span class="k">return</span> <span class="nx">responses</span><span class="p">[</span> <span class="nx">finalDataType</span> <span class="p">];</span>
      <span class="p">}</span>
   <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-142">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-142">&#182;</a></div>
      <p>Chain conversions given the request and the original response</p></td>
   <td class="code">
      <div class="highlight"><pre>
   <span class="kd">function</span> <span class="nx">ajaxConvert</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">response</span><span class="p">)</span> <span class="p">{</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-143">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-143">&#182;</a></div>
      <p>Apply the dataFilter if provided</p></td>
   <td class="code">
      <div class="highlight"><pre>
      <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">dataFilter</span><span class="p">)</span> <span class="p">{</span>
         <span class="nx">response</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">dataFilter</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span> <span class="nx">s</span><span class="p">.</span><span class="nx">dataType</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="kd">var</span> <span class="nx">dataTypes</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">dataTypes</span><span class="p">,</span>
            <span class="nx">converters</span> <span class="o">=</span> <span class="p">{},</span>
            <span class="nx">i</span><span class="p">,</span>
            <span class="nx">key</span><span class="p">,</span>
            <span class="nx">length</span> <span class="o">=</span> <span class="nx">dataTypes</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
            <span class="nx">tmp</span><span class="p">,</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-144">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-144">&#182;</a></div>
      <p>Current and previous dataTypes</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="nx">current</span> <span class="o">=</span> <span class="nx">dataTypes</span><span class="p">[</span> <span class="mi">0</span> <span class="p">],</span>
            <span class="nx">prev</span><span class="p">,</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-145">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-145">&#182;</a></div>
      <p>Conversion expression</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="nx">conversion</span><span class="p">,</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-146">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-146">&#182;</a></div>
      <p>Conversion function</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="nx">conv</span><span class="p">,</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-147">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-147">&#182;</a></div>
      <p>Conversion functions (transitive conversion)</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="nx">conv1</span><span class="p">,</span>
            <span class="nx">conv2</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-148">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-148">&#182;</a></div>
      <p>For each dataType in the chain</p></td>
   <td class="code">
      <div class="highlight"><pre>
      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-149">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-149">&#182;</a></div>
      <p>Create converters map
         with lowercased keys</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">s</span><span class="p">.</span><span class="nx">converters</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">key</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span><span class="p">)</span> <span class="p">{</span>
                  <span class="nx">converters</span><span class="p">[</span> <span class="nx">key</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">converters</span><span class="p">[</span> <span class="nx">key</span> <span class="p">];</span>
               <span class="p">}</span>
            <span class="p">}</span>
         <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-150">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-150">&#182;</a></div>
      <p>Get the dataTypes</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">prev</span> <span class="o">=</span> <span class="nx">current</span><span class="p">;</span>
         <span class="nx">current</span> <span class="o">=</span> <span class="nx">dataTypes</span><span class="p">[</span> <span class="nx">i</span> <span class="p">];</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-151">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-151">&#182;</a></div>
      <p>If current is auto dataType, update it to prev</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">if</span> <span class="p">(</span><span class="nx">current</span> <span class="o">===</span> <span class="s2">&quot;*&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">current</span> <span class="o">=</span> <span class="nx">prev</span><span class="p">;</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-152">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-152">&#182;</a></div>
      <p>If no auto and dataTypes are actually different</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">prev</span> <span class="o">!==</span> <span class="s2">&quot;*&quot;</span> <span class="o">&amp;&amp;</span> <span class="nx">prev</span> <span class="o">!==</span> <span class="nx">current</span><span class="p">)</span> <span class="p">{</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-153">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-153">&#182;</a></div>
      <p>Get the converter</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="nx">conversion</span> <span class="o">=</span> <span class="nx">prev</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">;</span>
            <span class="nx">conv</span> <span class="o">=</span> <span class="nx">converters</span><span class="p">[</span> <span class="nx">conversion</span> <span class="p">]</span> <span class="o">||</span> <span class="nx">converters</span><span class="p">[</span> <span class="s2">&quot;* &quot;</span> <span class="o">+</span> <span class="nx">current</span> <span class="p">];</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-154">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-154">&#182;</a></div>
      <p>If there is no direct converter, search transitively</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">conv</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">conv2</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
               <span class="k">for</span> <span class="p">(</span><span class="nx">conv1</span> <span class="k">in</span> <span class="nx">converters</span><span class="p">)</span> <span class="p">{</span>
                  <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">conv1</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">);</span>
                  <span class="k">if</span> <span class="p">(</span><span class="nx">tmp</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="o">===</span> <span class="nx">prev</span> <span class="o">||</span> <span class="nx">tmp</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="o">===</span> <span class="s2">&quot;*&quot;</span><span class="p">)</span> <span class="p">{</span>
                     <span class="nx">conv2</span> <span class="o">=</span> <span class="nx">converters</span><span class="p">[</span> <span class="nx">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">current</span> <span class="p">];</span>
                     <span class="k">if</span> <span class="p">(</span><span class="nx">conv2</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">conv1</span> <span class="o">=</span> <span class="nx">converters</span><span class="p">[</span> <span class="nx">conv1</span> <span class="p">];</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">conv1</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
                           <span class="nx">conv</span> <span class="o">=</span> <span class="nx">conv2</span><span class="p">;</span>
                        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">conv2</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
                           <span class="nx">conv</span> <span class="o">=</span> <span class="nx">conv1</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="k">break</span><span class="p">;</span>
                     <span class="p">}</span>
                  <span class="p">}</span>
               <span class="p">}</span>
            <span class="p">}</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-155">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-155">&#182;</a></div>
      <p>If we found no converter, dispatch an error</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span> <span class="nx">conv</span> <span class="o">||</span> <span class="nx">conv2</span> <span class="p">))</span> <span class="p">{</span>
               <span class="nx">jQuery</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;No conversion from &quot;</span> <span class="o">+</span> <span class="nx">conversion</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot; to &quot;</span><span class="p">));</span>
            <span class="p">}</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-156">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-156">&#182;</a></div>
      <p>If found converter is not an equivalence</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">conv</span> <span class="o">!==</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-157">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-157">&#182;</a></div>
      <p>Convert with 1 or 2 converters accordingly</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">response</span> <span class="o">=</span> <span class="nx">conv</span> <span class="o">?</span> <span class="nx">conv</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="o">:</span> <span class="nx">conv2</span><span class="p">(</span><span class="nx">conv1</span><span class="p">(</span><span class="nx">response</span><span class="p">));</span>
            <span class="p">}</span>
         <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">response</span><span class="p">;</span>
   <span class="p">}</span>

<span class="p">})(</span><span class="nx">jQuery</span><span class="p">);</span>



</pre>
      </div>
   </td>
</tr>
<tr id="section-158">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-158">&#182;</a></div>
      <p><strong>Original Source: ajax/jsonp.js</strong></p></td>
   <td class="code">
      <div class="highlight"><pre>
<span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">jQuery</span><span class="p">)</span> <span class="p">{</span>

   <span class="kd">var</span> <span class="nx">jsc</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span>
         <span class="nx">jsre</span> <span class="o">=</span> <span class="sr">/(\=)\?(&amp;|$)|\?\?/i</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-159">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-159">&#182;</a></div>
      <p>Default jsonp settings</p></td>
   <td class="code">
      <div class="highlight"><pre>
   <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ajaxSetup</span><span class="p">({</span>
      <span class="nx">jsonp</span><span class="o">:</span>        <span class="s2">&quot;callback&quot;</span><span class="p">,</span>
      <span class="nx">jsonpCallback</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
         <span class="k">return</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">expando</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="p">(</span> <span class="nx">jsc</span><span class="o">++</span> <span class="p">);</span>
      <span class="p">}</span>
   <span class="p">});</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-160">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-160">&#182;</a></div>
      <p>Detect, normalize options and install callbacks for jsonp requests</p></td>
   <td class="code">
      <div class="highlight"><pre>
   <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ajaxPrefilter</span><span class="p">(</span><span class="s2">&quot;json jsonp&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">originalSettings</span><span class="p">,</span> <span class="nx">jqXHR</span><span class="p">)</span> <span class="p">{</span>

      <span class="kd">var</span> <span class="nx">inspectData</span> <span class="o">=</span> <span class="p">(</span> <span class="k">typeof</span> <span class="nx">s</span><span class="p">.</span><span class="nx">data</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="sr">/^application\/x\-www\-form\-urlencoded/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">contentType</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">dataTypes</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="o">===</span> <span class="s2">&quot;jsonp&quot;</span> <span class="o">||</span>
            <span class="nx">s</span><span class="p">.</span><span class="nx">jsonp</span> <span class="o">!==</span> <span class="kc">false</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="nx">jsre</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">url</span><span class="p">)</span> <span class="o">||</span>
                  <span class="nx">inspectData</span> <span class="o">&amp;&amp;</span> <span class="nx">jsre</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="p">))</span> <span class="p">{</span>

         <span class="kd">var</span> <span class="nx">responseContainer</span><span class="p">,</span>
               <span class="nx">jsonpCallback</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">jsonpCallback</span> <span class="o">=</span>
                     <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">jsonpCallback</span><span class="p">)</span> <span class="o">?</span> <span class="nx">s</span><span class="p">.</span><span class="nx">jsonpCallback</span><span class="p">()</span> <span class="o">:</span> <span class="nx">s</span><span class="p">.</span><span class="nx">jsonpCallback</span><span class="p">,</span>
               <span class="nx">previous</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span> <span class="nx">jsonpCallback</span> <span class="p">],</span>
               <span class="nx">url</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span>
               <span class="nx">data</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span>
               <span class="nx">replace</span> <span class="o">=</span> <span class="s2">&quot;$1&quot;</span> <span class="o">+</span> <span class="nx">jsonpCallback</span> <span class="o">+</span> <span class="s2">&quot;$2&quot;</span><span class="p">;</span>

         <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">jsonp</span> <span class="o">!==</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">url</span> <span class="o">=</span> <span class="nx">url</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">jsre</span><span class="p">,</span> <span class="nx">replace</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">url</span> <span class="o">===</span> <span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">if</span> <span class="p">(</span><span class="nx">inspectData</span><span class="p">)</span> <span class="p">{</span>
                  <span class="nx">data</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">jsre</span><span class="p">,</span> <span class="nx">replace</span><span class="p">);</span>
               <span class="p">}</span>
               <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">data</span> <span class="o">===</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-161">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-161">&#182;</a></div>
      <p>Add callback manually</p></td>
   <td class="code">
      <div class="highlight"><pre>
                  <span class="nx">url</span> <span class="o">+=</span> <span class="p">(</span><span class="sr">/\?/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;&amp;&quot;</span> <span class="o">:</span> <span class="s2">&quot;?&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">s</span><span class="p">.</span><span class="nx">jsonp</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">+</span> <span class="nx">jsonpCallback</span><span class="p">;</span>
               <span class="p">}</span>
            <span class="p">}</span>
         <span class="p">}</span>

         <span class="nx">s</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="nx">url</span><span class="p">;</span>
         <span class="nx">s</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-162">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-162">&#182;</a></div>
      <p>Install callback</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nb">window</span><span class="p">[</span> <span class="nx">jsonpCallback</span> <span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">responseContainer</span> <span class="o">=</span> <span class="p">[</span> <span class="nx">response</span> <span class="p">];</span>
         <span class="p">};</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-163">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-163">&#182;</a></div>
      <p>Clean-up function</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">always</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-164">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-164">&#182;</a></div>
      <p>Set callback back to previous value</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="nb">window</span><span class="p">[</span> <span class="nx">jsonpCallback</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">previous</span><span class="p">;</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-165">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-165">&#182;</a></div>
      <p>Call if it was a function and we have a response</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">responseContainer</span> <span class="o">&amp;&amp;</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">previous</span><span class="p">))</span> <span class="p">{</span>
               <span class="nb">window</span><span class="p">[</span> <span class="nx">jsonpCallback</span> <span class="p">](</span><span class="nx">responseContainer</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]);</span>
            <span class="p">}</span>
         <span class="p">});</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-166">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-166">&#182;</a></div>
      <p>Use data converter to retrieve json after script execution</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">s</span><span class="p">.</span><span class="nx">converters</span><span class="p">[</span><span class="s2">&quot;script json&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">responseContainer</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">jQuery</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">jsonpCallback</span> <span class="o">+</span> <span class="s2">&quot; was not called&quot;</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">responseContainer</span><span class="p">[</span> <span class="mi">0</span> <span class="p">];</span>
         <span class="p">};</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-167">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-167">&#182;</a></div>
      <p>force json dataType</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">s</span><span class="p">.</span><span class="nx">dataTypes</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;json&quot;</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-168">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-168">&#182;</a></div>
      <p>Delegate to script</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">return</span> <span class="s2">&quot;script&quot;</span><span class="p">;</span>
      <span class="p">}</span>
   <span class="p">});</span>

<span class="p">})(</span><span class="nx">jQuery</span><span class="p">);</span>



</pre>
      </div>
   </td>
</tr>
<tr id="section-169">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-169">&#182;</a></div>
      <p><strong>Original Source: ajax/script.js</strong></p></td>
   <td class="code">
      <div class="highlight"><pre>
<span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">jQuery</span><span class="p">)</span> <span class="p">{</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-170">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-170">&#182;</a></div>
      <p>Install script dataType</p></td>
   <td class="code">
      <div class="highlight"><pre>
   <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ajaxSetup</span><span class="p">({</span>
      <span class="nx">accepts</span><span class="o">:</span>   <span class="p">{</span>
         <span class="nx">script</span><span class="o">:</span><span class="s2">&quot;text/javascript, application/javascript, application/ecmascript, application/x-ecmascript&quot;</span>
      <span class="p">},</span>
      <span class="nx">contents</span><span class="o">:</span>  <span class="p">{</span>
         <span class="nx">script</span><span class="o">:</span><span class="sr">/javascript|ecmascript/</span>
      <span class="p">},</span>
      <span class="nx">converters</span><span class="o">:</span><span class="p">{</span>
         <span class="s2">&quot;text script&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">text</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">jQuery</span><span class="p">.</span><span class="nx">globalEval</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>
            <span class="k">return</span> <span class="nx">text</span><span class="p">;</span>
         <span class="p">}</span>
      <span class="p">}</span>
   <span class="p">});</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-171">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-171">&#182;</a></div>
      <p>Handle cache's special case and global</p></td>
   <td class="code">
      <div class="highlight"><pre>
   <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ajaxPrefilter</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">cache</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
         <span class="nx">s</span><span class="p">.</span><span class="nx">cache</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">crossDomain</span><span class="p">)</span> <span class="p">{</span>
         <span class="nx">s</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;GET&quot;</span><span class="p">;</span>
         <span class="nx">s</span><span class="p">.</span><span class="nx">global</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
   <span class="p">});</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-172">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-172">&#182;</a></div>
      <p>Bind script tag hack transport</p></td>
   <td class="code">
      <div class="highlight"><pre>
   <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ajaxTransport</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-173">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-173">&#182;</a></div>
      <p>This transport only deals with cross domain requests</p></td>
   <td class="code">
      <div class="highlight"><pre>
      <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">crossDomain</span><span class="p">)</span> <span class="p">{</span>

         <span class="kd">var</span> <span class="nx">script</span><span class="p">,</span>
               <span class="nx">head</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">head</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;head&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">;</span>

         <span class="k">return</span> <span class="p">{</span>

            <span class="nx">send</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">_</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>

               <span class="nx">script</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">);</span>

               <span class="nx">script</span><span class="p">.</span><span class="nx">async</span> <span class="o">=</span> <span class="s2">&quot;async&quot;</span><span class="p">;</span>

               <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">scriptCharset</span><span class="p">)</span> <span class="p">{</span>
                  <span class="nx">script</span><span class="p">.</span><span class="nx">charset</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">scriptCharset</span><span class="p">;</span>
               <span class="p">}</span>

               <span class="nx">script</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">url</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-174">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-174">&#182;</a></div>
      <p>Attach handlers for all browsers</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">script</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="nx">script</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">_</span><span class="p">,</span> <span class="nx">isAbort</span><span class="p">)</span> <span class="p">{</span>

                  <span class="k">if</span> <span class="p">(</span><span class="nx">isAbort</span> <span class="o">||</span> <span class="o">!</span><span class="nx">script</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">||</span> <span class="sr">/loaded|complete/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">script</span><span class="p">.</span><span class="nx">readyState</span><span class="p">))</span> <span class="p">{</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-175">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-175">&#182;</a></div>
      <p>Handle memory leak in IE</p></td>
   <td class="code">
      <div class="highlight"><pre>
                     <span class="nx">script</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="nx">script</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-176">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-176">&#182;</a></div>
      <p>Remove the script</p></td>
   <td class="code">
      <div class="highlight"><pre>
                     <span class="k">if</span> <span class="p">(</span><span class="nx">head</span> <span class="o">&amp;&amp;</span> <span class="nx">script</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">head</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">script</span><span class="p">);</span>
                     <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-177">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-177">&#182;</a></div>
      <p>Dereference the script</p></td>
   <td class="code">
      <div class="highlight"><pre>
                     <span class="nx">script</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-178">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-178">&#182;</a></div>
      <p>Callback if not abort</p></td>
   <td class="code">
      <div class="highlight"><pre>
                     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isAbort</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="s2">&quot;success&quot;</span><span class="p">);</span>
                     <span class="p">}</span>
                  <span class="p">}</span>
               <span class="p">};</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-179">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-179">&#182;</a></div>
      <p>Use insertBefore instead of appendChild to circumvent an IE6 bug.
         This arises when a base node is used (#2709 and #4378).</p></td>
   <td class="code">
      <div class="highlight"><pre>
               <span class="nx">head</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">script</span><span class="p">,</span> <span class="nx">head</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">);</span>
            <span class="p">},</span>

            <span class="nx">abort</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
               <span class="k">if</span> <span class="p">(</span><span class="nx">script</span><span class="p">)</span> <span class="p">{</span>
                  <span class="nx">script</span><span class="p">.</span><span class="nx">onload</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
               <span class="p">}</span>
            <span class="p">}</span>
         <span class="p">};</span>
      <span class="p">}</span>
   <span class="p">});</span>

<span class="p">})(</span><span class="nx">jQuery</span><span class="p">);</span>



</pre>
      </div>
   </td>
</tr>
<tr id="section-180">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-180">&#182;</a></div>
      <p><strong>Original Source: ajax/xhr.js</strong></p></td>
   <td class="code">
      <div class="highlight"><pre>
<span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">jQuery</span><span class="p">)</span> <span class="p">{</span>

   <span class="kd">var</span> <span class="c1">// 5280: Internet Explorer will keep connections alive if we don&#39;t abort on unload</span>
         <span class="nx">xhrOnUnloadAbort</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ActiveXObject</span> <span class="o">?</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-181">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-181">&#182;</a></div>
      <p>Abort all pending requests</p></td>
   <td class="code">
      <div class="highlight"><pre>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">xhrCallbacks</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">xhrCallbacks</span><span class="p">[</span> <span class="nx">key</span> <span class="p">](</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
            <span class="p">}</span>
         <span class="p">}</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
         <span class="nx">xhrId</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
         <span class="nx">xhrCallbacks</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-182">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-182">&#182;</a></div>
      <p>Functions to create xhrs</p></td>
   <td class="code">
      <div class="highlight"><pre>
   <span class="kd">function</span> <span class="nx">createStandardXHR</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">try</span> <span class="p">{</span>
         <span class="k">return</span> <span class="k">new</span> <span class="nb">window</span><span class="p">.</span><span class="nx">XMLHttpRequest</span><span class="p">();</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="p">}</span>
   <span class="p">}</span>

   <span class="kd">function</span> <span class="nx">createActiveXHR</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">try</span> <span class="p">{</span>
         <span class="k">return</span> <span class="k">new</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ActiveXObject</span><span class="p">(</span><span class="s2">&quot;Microsoft.XMLHTTP&quot;</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="p">}</span>
   <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-183">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-183">&#182;</a></div>
      <p>Create the request object
         (This is still attached to ajaxSettings for backward compatibility)</p></td>
   <td class="code">
      <div class="highlight"><pre>
   <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ajaxSettings</span><span class="p">.</span><span class="nx">xhr</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ActiveXObject</span> <span class="o">?</span>
      <span class="cm">/* Microsoft failed to properly</span>
<span class="cm">       * implement the XMLHttpRequest in IE7 (can&#39;t request local files),</span>
<span class="cm">       * so we use the ActiveXObject when it is available</span>
<span class="cm">       * Additionally XMLHttpRequest can be disabled in IE7/IE8 so</span>
<span class="cm">       * we need a fallback.</span>
<span class="cm">       */</span>
         <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isLocal</span> <span class="o">&amp;&amp;</span> <span class="nx">createStandardXHR</span><span class="p">()</span> <span class="o">||</span> <span class="nx">createActiveXHR</span><span class="p">();</span>
         <span class="p">}</span> <span class="o">:</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-184">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-184">&#182;</a></div>
      <p>For all other browsers, use the standard XMLHttpRequest object</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="nx">createStandardXHR</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-185">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-185">&#182;</a></div>
      <p>Determine support properties</p></td>
   <td class="code">
      <div class="highlight"><pre>
   <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">jQuery</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">support</span><span class="p">,</span> <span class="p">{</span>
         <span class="nx">ajax</span><span class="o">:!!</span><span class="nx">xhr</span><span class="p">,</span>
         <span class="nx">cors</span><span class="o">:!!</span><span class="nx">xhr</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="s2">&quot;withCredentials&quot;</span> <span class="k">in</span> <span class="nx">xhr</span> <span class="p">)</span>
      <span class="p">});</span>
   <span class="p">})(</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">ajaxSettings</span><span class="p">.</span><span class="nx">xhr</span><span class="p">());</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-186">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-186">&#182;</a></div>
      <p>Create transport if the browser can provide an xhr</p></td>
   <td class="code">
      <div class="highlight"><pre>
   <span class="k">if</span> <span class="p">(</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">ajax</span><span class="p">)</span> <span class="p">{</span>

      <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ajaxTransport</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-187">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-187">&#182;</a></div>
      <p>Cross domain only allowed if supported through XMLHttpRequest</p></td>
   <td class="code">
      <div class="highlight"><pre>
         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">s</span><span class="p">.</span><span class="nx">crossDomain</span> <span class="o">||</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">cors</span><span class="p">)</span> <span class="p">{</span>

            <span class="kd">var</span> <span class="nx">callback</span><span class="p">;</span>

            <span class="k">return</span> <span class="p">{</span>
               <span class="nx">send</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">headers</span><span class="p">,</span> <span class="nx">complete</span><span class="p">)</span> <span class="p">{</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-188">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-188">&#182;</a></div>
      <p>Get a new xhr</p></td>
   <td class="code">
      <div class="highlight"><pre>
                  <span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">xhr</span><span class="p">(),</span>
                        <span class="nx">handle</span><span class="p">,</span>
                        <span class="nx">i</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-189">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-189">&#182;</a></div>
      <p>Open the socket
         Passing null username, generates a login popup on Opera (#2865)</p></td>
   <td class="code">
      <div class="highlight"><pre>
                  <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">username</span><span class="p">)</span> <span class="p">{</span>
                     <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span> <span class="nx">s</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span> <span class="nx">s</span><span class="p">.</span><span class="nx">async</span><span class="p">,</span> <span class="nx">s</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span> <span class="nx">s</span><span class="p">.</span><span class="nx">password</span><span class="p">);</span>
                  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                     <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span> <span class="nx">s</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span> <span class="nx">s</span><span class="p">.</span><span class="nx">async</span><span class="p">);</span>
                  <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-190">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-190">&#182;</a></div>
      <p>Apply custom fields if provided</p></td>
   <td class="code">
      <div class="highlight"><pre>
                  <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">xhrFields</span><span class="p">)</span> <span class="p">{</span>
                     <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">s</span><span class="p">.</span><span class="nx">xhrFields</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">xhr</span><span class="p">[</span> <span class="nx">i</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">xhrFields</span><span class="p">[</span> <span class="nx">i</span> <span class="p">];</span>
                     <span class="p">}</span>
                  <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-191">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-191">&#182;</a></div>
      <p>Override mime type if needed</p></td>
   <td class="code">
      <div class="highlight"><pre>
                  <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">mimeType</span> <span class="o">&amp;&amp;</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">overrideMimeType</span><span class="p">)</span> <span class="p">{</span>
                     <span class="nx">xhr</span><span class="p">.</span><span class="nx">overrideMimeType</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">mimeType</span><span class="p">);</span>
                  <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-192">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-192">&#182;</a></div>
      <p>X-Requested-With header
         For cross-domain requests, seeing as conditions for a preflight are
         akin to a jigsaw puzzle, we simply never set it to be sure.
         (it can always be set on a per-request basis or even using ajaxSetup)
         For same-domain requests, won't change header if already provided.</p></td>
   <td class="code">
      <div class="highlight"><pre>
                  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">s</span><span class="p">.</span><span class="nx">crossDomain</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">headers</span><span class="p">[</span><span class="s2">&quot;X-Requested-With&quot;</span><span class="p">])</span> <span class="p">{</span>
                     <span class="nx">headers</span><span class="p">[</span> <span class="s2">&quot;X-Requested-With&quot;</span> <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;XMLHttpRequest&quot;</span><span class="p">;</span>
                  <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-193">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-193">&#182;</a></div>
      <p>Need an extra try/catch for cross domain requests in Firefox 3</p></td>
   <td class="code">
      <div class="highlight"><pre>
                  <span class="k">try</span> <span class="p">{</span>
                     <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">headers</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">headers</span><span class="p">[</span> <span class="nx">i</span> <span class="p">]);</span>
                     <span class="p">}</span>
                  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">_</span><span class="p">)</span> <span class="p">{</span>
                  <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-194">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-194">&#182;</a></div>
      <p>Do send the request
         This may raise an exception which is actually
         handled in jQuery.ajax (so no try/catch here)</p></td>
   <td class="code">
      <div class="highlight"><pre>
                  <span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">((</span> <span class="nx">s</span><span class="p">.</span><span class="nx">hasContent</span> <span class="o">&amp;&amp;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">data</span> <span class="p">)</span> <span class="o">||</span> <span class="kc">null</span><span class="p">);</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-195">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-195">&#182;</a></div>
      <p>Listener</p></td>
   <td class="code">
      <div class="highlight"><pre>
                  <span class="nx">callback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">_</span><span class="p">,</span> <span class="nx">isAbort</span><span class="p">)</span> <span class="p">{</span>

                     <span class="kd">var</span> <span class="nx">status</span><span class="p">,</span>
                           <span class="nx">statusText</span><span class="p">,</span>
                           <span class="nx">responseHeaders</span><span class="p">,</span>
                           <span class="nx">responses</span><span class="p">,</span>
                           <span class="nx">xml</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-196">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-196">&#182;</a></div>
      <p>Firefox throws exceptions when accessing properties
         of an xhr when a network error occured
         http://helpful.knobs-dials.com/index.php/Component<em>returned</em>failure<em>code:</em>0x80040111<em>(NS</em>ERROR<em>NOT</em>AVAILABLE)
      </p></td>
   <td class="code">
      <div class="highlight"><pre>
                     <span class="k">try</span> <span class="p">{</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-197">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-197">&#182;</a></div>
      <p>Was never called and is aborted or complete</p></td>
   <td class="code">
      <div class="highlight"><pre>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="nx">isAbort</span> <span class="o">||</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="mi">4</span> <span class="p">))</span> <span class="p">{</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-198">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-198">&#182;</a></div>
      <p>Only called once</p></td>
   <td class="code">
      <div class="highlight"><pre>
                           <span class="nx">callback</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-199">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-199">&#182;</a></div>
      <p>Do not keep as active anymore</p></td>
   <td class="code">
      <div class="highlight"><pre>
                           <span class="k">if</span> <span class="p">(</span><span class="nx">handle</span><span class="p">)</span> <span class="p">{</span>
                              <span class="nx">xhr</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">noop</span><span class="p">;</span>
                              <span class="k">if</span> <span class="p">(</span><span class="nx">xhrOnUnloadAbort</span><span class="p">)</span> <span class="p">{</span>
                                 <span class="k">delete</span> <span class="nx">xhrCallbacks</span><span class="p">[</span> <span class="nx">handle</span> <span class="p">];</span>
                              <span class="p">}</span>
                           <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-200">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-200">&#182;</a></div>
      <p>If it's an abort</p></td>
   <td class="code">
      <div class="highlight"><pre>
                           <span class="k">if</span> <span class="p">(</span><span class="nx">isAbort</span><span class="p">)</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-201">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-201">&#182;</a></div>
      <p>Abort it manually if needed</p></td>
   <td class="code">
      <div class="highlight"><pre>
                              <span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">!==</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
                                 <span class="nx">xhr</span><span class="p">.</span><span class="nx">abort</span><span class="p">();</span>
                              <span class="p">}</span>
                           <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                              <span class="nx">status</span> <span class="o">=</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span><span class="p">;</span>
                              <span class="nx">responseHeaders</span> <span class="o">=</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">getAllResponseHeaders</span><span class="p">();</span>
                              <span class="nx">responses</span> <span class="o">=</span> <span class="p">{};</span>
                              <span class="nx">xml</span> <span class="o">=</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">responseXML</span><span class="p">;</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-202">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-202">&#182;</a></div>
      <p>Construct response list</p></td>
   <td class="code">
      <div class="highlight"><pre>
                              <span class="k">if</span> <span class="p">(</span><span class="nx">xml</span> <span class="o">&amp;&amp;</span> <span class="nx">xml</span><span class="p">.</span><span class="nx">documentElement</span> <span class="cm">/* #4958 */</span><span class="p">)</span> <span class="p">{</span>
                                 <span class="nx">responses</span><span class="p">.</span><span class="nx">xml</span> <span class="o">=</span> <span class="nx">xml</span><span class="p">;</span>
                              <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-203">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-203">&#182;</a></div>
      <p>When requesting binary data, IE6-9 will throw an exception
         on any attempt to access responseText (#11426)</p></td>
   <td class="code">
      <div class="highlight"><pre>
                              <span class="k">try</span> <span class="p">{</span>
                                 <span class="nx">responses</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span>
                              <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">_</span><span class="p">)</span> <span class="p">{</span>
                              <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-204">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-204">&#182;</a></div>
      <p>Firefox throws an exception when accessing
         statusText for faulty cross-domain requests</p></td>
   <td class="code">
      <div class="highlight"><pre>
                              <span class="k">try</span> <span class="p">{</span>
                                 <span class="nx">statusText</span> <span class="o">=</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">statusText</span><span class="p">;</span>
                              <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-205">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-205">&#182;</a></div>
      <p>We normalize with Webkit giving an empty statusText</p></td>
   <td class="code">
      <div class="highlight"><pre>
                                 <span class="nx">statusText</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
                              <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-206">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-206">&#182;</a></div>
      <p>Filter status for non standard behaviors</p></td>
   <td class="code">
      <div class="highlight"><pre>


</pre>
      </div>
   </td>
</tr>
<tr id="section-207">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-207">&#182;</a></div>
      <p>If the request is local and we have data: assume a success
         (success with no data won't get notified, that's the best we
         can do given current implementations)</p></td>
   <td class="code">
      <div class="highlight"><pre>
                              <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">status</span> <span class="o">&amp;&amp;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">isLocal</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">s</span><span class="p">.</span><span class="nx">crossDomain</span><span class="p">)</span> <span class="p">{</span>
                                 <span class="nx">status</span> <span class="o">=</span> <span class="nx">responses</span><span class="p">.</span><span class="nx">text</span> <span class="o">?</span> <span class="mi">200</span> <span class="o">:</span> <span class="mi">404</span><span class="p">;</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-208">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-208">&#182;</a></div>
      <p>IE - #1450: sometimes returns 1223 when it should be 204</p></td>
   <td class="code">
      <div class="highlight"><pre>
                              <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">1223</span><span class="p">)</span> <span class="p">{</span>
                                 <span class="nx">status</span> <span class="o">=</span> <span class="mi">204</span><span class="p">;</span>
                              <span class="p">}</span>
                           <span class="p">}</span>
                        <span class="p">}</span>
                     <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">firefoxAccessException</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isAbort</span><span class="p">)</span> <span class="p">{</span>
                           <span class="nx">complete</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">firefoxAccessException</span><span class="p">);</span>
                        <span class="p">}</span>
                     <span class="p">}</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-209">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-209">&#182;</a></div>
      <p>Call complete if needed</p></td>
   <td class="code">
      <div class="highlight"><pre>
                     <span class="k">if</span> <span class="p">(</span><span class="nx">responses</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">complete</span><span class="p">(</span><span class="nx">status</span><span class="p">,</span> <span class="nx">statusText</span><span class="p">,</span> <span class="nx">responses</span><span class="p">,</span> <span class="nx">responseHeaders</span><span class="p">);</span>
                     <span class="p">}</span>
                  <span class="p">};</span>


</pre>
      </div>
   </td>
</tr>
<tr id="section-210">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-210">&#182;</a></div>
      <p>if we're in sync mode or it's in cache
         and has been retrieved directly (IE6 &amp; IE7)
         we need to manually fire the callback</p></td>
   <td class="code">
      <div class="highlight"><pre>
                  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">s</span><span class="p">.</span><span class="nx">async</span> <span class="o">||</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
                     <span class="nx">callback</span><span class="p">();</span>
                  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                     <span class="nx">handle</span> <span class="o">=</span> <span class="o">++</span><span class="nx">xhrId</span><span class="p">;</span>
                     <span class="k">if</span> <span class="p">(</span><span class="nx">xhrOnUnloadAbort</span><span class="p">)</span> <span class="p">{</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-211">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-211">&#182;</a></div>
      <p>Create the active xhrs callbacks list if needed
         and attach the unload handler</p></td>
   <td class="code">
      <div class="highlight"><pre>
                        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">xhrCallbacks</span><span class="p">)</span> <span class="p">{</span>
                           <span class="nx">xhrCallbacks</span> <span class="o">=</span> <span class="p">{};</span>
                           <span class="nx">jQuery</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">unload</span><span class="p">(</span><span class="nx">xhrOnUnloadAbort</span><span class="p">);</span>
                        <span class="p">}</span>

</pre>
      </div>
   </td>
</tr>
<tr id="section-212">
   <td class="docs">
      <div class="pilwrap"><a class="pilcrow" href="#section-212">&#182;</a></div>
      <p>Add to list of active xhrs callbacks</p></td>
   <td class="code">
      <div class="highlight"><pre>
                        <span class="nx">xhrCallbacks</span><span class="p">[</span> <span class="nx">handle</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">;</span>
                     <span class="p">}</span>
                     <span class="nx">xhr</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">;</span>
                  <span class="p">}</span>
               <span class="p">},</span>

               <span class="nx">abort</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                  <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                     <span class="nx">callback</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
                  <span class="p">}</span>
               <span class="p">}</span>
            <span class="p">};</span>
         <span class="p">}</span>
      <span class="p">});</span>
   <span class="p">}</span>

<span class="p">})(</span><span class="nx">jQuery</span><span class="p">);</span>

</pre>
      </div>
   </td>
</tr>
</tbody>
</table>
</div>
</body>
</html>